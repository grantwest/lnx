defmodule Volta.Core.OnionTest do
  use ExUnit.Case, async: true
  alias Volta.Core.Onion.OnionPacketV0
  alias Volta.Core.Onion.PerHop
  alias Volta.KeyUtils

  test "parse & encode realm 0 per_hop" do
    binary = <<
      0, 0, 0, 0, 0, 0, 0, 1, # short_channel_id = 1
      0, 0, 0, 0, 0, 0, 0, 2, # amt_to_forward = 2
      0, 0, 0, 3,             # outgoing_cltv_value = 3
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, # padding
    >>
    realm = 0
    msg = %PerHop{short_channel_id: 1, amt_to_forward: 2, outgoing_cltv_value: 3}
    assert PerHop.parse(realm, binary) == msg
    assert PerHop.encode(msg) == binary
  end

  test "bolt 4 (onion) test vector" do
    pubkey_0 = "02eec7245d6b7d2ccb30380bfbe2a3648cd7a942653f5aa340edcea1f283686619" |> bin()
    pubkey_1 = "0324653eac434488002cc06bbfb7f10fe18991e35f9fe4302dbea6d2353dc0ab1c" |> bin()
    pubkey_2 = "027f31ebc5462c1fdce1b737ecff52d37d75dea43ce11c74d25aa297165faa2007" |> bin()
    pubkey_3 = "032c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991" |> bin()
    pubkey_4 = "02edabbd16b41c8371b92ef2f04c1185b4f03b6dcd52ba9b78d9d7c89c8f221145" |> bin()

    session_key = "4141414141414141414141414141414141414141414141414141414141414141" |> bin()
    associated_data = "4242424242424242424242424242424242424242424242424242424242424242" |> bin()

    hop_payload_0 = "000000000000000000000000000000000000000000000000000000000000000000" |> parse_hop_payload_hex()
    hop_payload_1 = "000101010101010101000000000000000100000001000000000000000000000000" |> parse_hop_payload_hex()
    hop_payload_2 = "000202020202020202000000000000000200000002000000000000000000000000" |> parse_hop_payload_hex()
    hop_payload_3 = "000303030303030303000000000000000300000003000000000000000000000000" |> parse_hop_payload_hex()
    hop_payload_4 = "000404040404040404000000000000000400000004000000000000000000000000" |> parse_hop_payload_hex()

    hop_shared_secret_0 = "53eb63ea8a3fec3b3cd433b85cd62a4b145e1dda09391b348c4e1cd36a03ea66"
    hop_blinding_factor_0 = "2ec2e5da605776054187180343287683aa6a51b4b1c04d6dd49c45d8cffb3c36"
    hop_ephemeral_pubkey_0 = "02eec7245d6b7d2ccb30380bfbe2a3648cd7a942653f5aa340edcea1f283686619"

    hop_shared_secret_1 = "a6519e98832a0b179f62123b3567c106db99ee37bef036e783263602f3488fae"
    hop_blinding_factor_1 = "bf66c28bc22e598cfd574a1931a2bafbca09163df2261e6d0056b2610dab938f"
    hop_ephemeral_pubkey_1 = "028f9438bfbf7feac2e108d677e3a82da596be706cc1cf342b75c7b7e22bf4e6e2"

    hop_shared_secret_2 = "3a6b412548762f0dbccce5c7ae7bb8147d1caf9b5471c34120b30bc9c04891cc"
    hop_blinding_factor_2 = "a1f2dadd184eb1627049673f18c6325814384facdee5bfd935d9cb031a1698a5"
    hop_ephemeral_pubkey_2 = "03bfd8225241ea71cd0843db7709f4c222f62ff2d4516fd38b39914ab6b83e0da0"

    hop_shared_secret_3 = "21e13c2d7cfe7e18836df50872466117a295783ab8aab0e7ecc8c725503ad02d"
    hop_blinding_factor_3 = "7cfe0b699f35525029ae0fa437c69d0f20f7ed4e3916133f9cacbb13c82ff262"
    hop_ephemeral_pubkey_3 = "031dde6926381289671300239ea8e57ffaf9bebd05b9a5b95beaf07af05cd43595"

    hop_shared_secret_4 = "b5756b9b542727dbafc6765a49488b023a725d631af688fc031217e90770c328"
    hop_blinding_factor_4 = "c96e00dddaf57e7edcd4fb5954be5b65b09f17cb6d20651b4e90315be5779205"
    hop_ephemeral_pubkey_4 = "03a214ebd875aab6ddfd77f22c5e7311d7f77f17a169e599f157bbcdae8bf071f4"

    expected_filler = "c6b008cf6414ed6e4c42c291eb505e9f22f5fe7d0ecdd15a833f4d016ac974d33adc6ea3293e20859e87ebfb937ba406abd025d14af692b12e9c9c2adbe307a679779259676211c071e614fdb386d1ff02db223a5b2fae03df68d321c7b29f7c7240edd3fa1b7cb6903f89dc01abf41b2eb0b49b6b8d73bb0774b58204c0d0e96d3cce45ad75406be0bc009e327b3e712a4bd178609c00b41da2daf8a4b0e1319f07a492ab4efb056f0f599f75e6dc7e0d10ce1cf59088ab6e873de377343880f7a24f0e36731a0b72092f8d5bc8cd346762e93b2bf203d00264e4bc136fc142de8f7b69154deb05854ea88e2d7506222c95ba1aab065c8a851391377d3406a35a9af3ac"

    rhokey_4 = "034e18b8cc718e8af6339106e706c52d8df89e2b1f7e9142d996acf88df8799b"
    mukey_4 = "8e45e5c61c2b24cb6382444db6698727afb063adecd72aada233d4bf273d975a"
    #routing_info_4_unencrypted = "00040404040404040400000004000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    routing_info_4_unencrypted = "00040404040404040400000000000000040000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    # routing_info_4_encrypted = "f6a9e85e5c6a0458c98282b786ffe8efb2f3f0e2cee0283a71aa4d873686d7efeac03dcb113fd91113df4bb5d5e8c13cde4bd12eced21d367381fdc31efe09695d6ecc095083c1571d10ed076ee914745479dfedcab84efd3889e6375f544562ea4a6522035738a9ba1a9ab4204339569d3d0c217324f1d5f3a107e930ade50b913777d1140096e2b26ce47486b66a6740f026ae91429115e17270c5a542b4c82ce438725060248726956e7639da64a55cec00b61719383271e0ab97dafe44ad194e7338ea841bf25a505d0041eb53dc0d0e6c3f7986f6647ede9327467212a3ca5724ece8503bfaba3800372d747abe2c174cbc2da01dd967fc0bae56d2bc7184e1d5d823661b8ff06eb466d483d6fa69a4f8b592ebc3006b7c047055b12407925ea74c2bb09ca21f4bc9d39dc4a7237ef6facbb15f5ba56d8e2ab94ad24267bf85cea55b0605cd6260b4b0f17994a03e39bebfcad0834849b188e83bf5c954dc112d33b0fada26f25d76d53ec9b95ed344059a279719d5edc953a4de2b1cc4f47d5da090c3b0f4c7eef14830f9a2230bffb722f11fd2ea82c43d58261e5a868361262abbd81b9f1e6145562ed6765aac732e7d91bfff7716509d72314d46904bcc8053cfd1e3cd7824b4b6499bf8c77762275fa4f651d163a8701f02a5ca67bb7d37787a66d269d4079aa92a489493020b11d87791a3e3ef66780bd0007c8fa2782bac7a839b57e8ace7618a75fe03604097960d2236616d579207fb943c85bef4f804e7f13d7d78ff3aab0f7f440a3005a363f32c31567b8d64669a7ae0299b06b80e4d224d2d70b80077ff966cfb8c11cf763954f398c592ca619acc2e0e86dad54b9cfa47bc10520f3c9ba2e0d2e27e0ba8ef8ece3e71c8a1ff75fe0c8369a3555e42db30565b2e12a8e862d0f873bd781ebf8255372e540bf6fbf4c1dae200823144f8da8df82ccd41b1b678eb91a289b88c6ee5aff71d98b64e8b17e2027fcb6826c418dbdb51f06bec866d69d9554931412808bd90021be2e0dad1d1ececfdd41fcdf6f67b88ef09eb9edcc4c226e07bdfe86b8e50e3bf68b19c0c9e0bf9aaaaddb15bc05a5666733789fa6efde866a49d0329185d852dc84a7e16c41f6c2daadc04665197152d9c0db63d0bd926c06bf3646b810186ae908a2f27a33d010b3262b0c0805c3adf135b41f15a033bb82a8db2c38160dbce672290878d7ad8d08fdd483ef9d95b3a1b2ea2b6ff0adde762e9df7b78fe5f3644df54c6d98709d70924ce6ec94650cb207b4f90d35569acb55811ad3f01b28bb2b16cfde454531b9462024abf419fb3bef80db9bb9fa5bd62a7e94f61a667e74140c8da4b27ad7b934c0824756fbc56f8ac7529fc4c5224158fd4915eba25a3f2a72a7f718a5cda6395bd8b2bc484a950aba483c8cadec376f9bee62c93f886d83371b41c361a36c15679ff933422e09c5eaf98d3bdff98680040079daed1d88cfdb74a922c59c81327133971ae5755ffe589152b2d9423a0dcd6b9540cb57a3146fdc256c573c26aa148a00ef28441b3c49ceedff190da2380ebc7bc19ef3082a195f47fdf453e0e0a54e10811b604df1d3c2238d4ec13ce0feb73216a7f100fa6eb7953f42858ef190aad1d271a5262aefb8d7ee6430061899695058feb51c914dc93a24dd1b5cf2b54334b385c54bc9b83748b966fda0d55d8da3324aa1ce4f835d44b379e785b0a95c7c9f7bae6df9cad098f40b0b159e416c5ed4d60950b40a30ecc0c125dbe6ff2cfcec7f8d36925d4252f276279c4d3680bd7180b991a320eba22c5d71079630deae6bf4f766da7cf62d6c410eb5f"
    routing_info_4_encrypted = "f6a9e85e5c6a0458c98282b782ffe8efb2f3f0e2cae0283a71aa4d873686d7efeac03dcb113fd91113df4bb5d5e8c13cde4bd12eced21d367381fdc31efe09695d6ecc095083c1571d10ed076ee914745479dfedcab84efd3889e6375f544562ea4a6522035738a9ba1a9ab4204339569d3d0c217324f1d5f3a107e930ade50b913777d1140096e2b26ce47486b66a6740f026ae91429115e17270c5a542b4c82ce438725060248726956e7639da64a55cec00b61719383271e0ab97dafe44ad194e7338ea841bf25a505d0041eb53dc0d0e6c3f7986f6647ede9327467212a3ca5724ece8503bfaba3800372d747abe2c174cbc2da01dd967fc0bae56d2bc7184e1d5d823661b8ff06eb466d483d6fa69a4f8b592ebc3006b7c047055b12407925ea74c2bb09ca21f4bc9d39dc4a7237ef6facbb15f5ba56d8e2ab94ad24267bf85cea55b0605cd6260b4b0f17994a03e39bebfcad0834849b188e83bf5c954dc112d33b0fada26f25d76d53ec9b95ed344059a279719d5edc953a4de2b1cc4f47d5da090c3b0f4c7eef14830f9a2230bffb722f11fd2ea82c43d58261e5a868361262abbd81b9f1e6145562ed6765aac732e7d91bfff7716509d72314d46904bcc8053cfd1e3cd7824b4b6499bf8c77762275fa4f651d163a8701f02a5ca67bb7d37787a66d269d4079aa92a489493020b11d87791a3e3ef66780bd0007c8fa2782bac7a839b57e8ace7618a75fe03604097960d2236616d579207fb943c85bef4f804e7f13d7d78ff3aab0f7f440a3005a363f32c31567b8d64669a7ae0299b06b80e4d224d2d70b80077ff966cfb8c11cf763954f398c592ca619acc2e0e86dad54b9cfa47bc10520f3c9ba2e0d2e27e0ba8ef8ece3e71c8a1ff75fe0c8369a3555e42db30565b2e12a8e862d0f873bd781ebf8255372e540bf6fbf4c1dae200823144f8da8df82ccd41b1b678eb91a289b88c6ee5aff71d98b64e8b17e2027fcb6826c418dbdb51f06bec866d69d9554931412808bd90021be2e0dad1d1ececfdd41fcdf6f67b88ef09eb9edcc4c226e07bdfe86b8e50e3bf68b19c0c9e0bf9aaaaddb15bc05a5666733789fa6efde866a49d0329185d852dc84a7e16c41f6c2daadc04665197152d9c0db63d0bd926c06bf3646b810186ae908a2f27a33d010b3262b0c0805c3adf135b41f15a033bb82a8db2c38160dbce672290878d7ad8d08fdd483ef9d95b3a1b2ea2b6ff0adde762e9df7b78fe5f3644df54c6d98709d70924ce6ec94650cb207b4f90d35569acb55811ad3f01b28bb2b16cfde454531b9462024abf419fb3bef80db9bb9fa5bd62a7e94f61a667e74140c8da4b27ad7b934c0824756fbc56f8ac7529fc4c5224158fd4915eba25a3f2a72a7f718a5cda6395bd8b2bc484a950aba483c8cadec376f9bee62c93f886d83371b41c361a36c15679ff933422e09c5eaf98d3bdff98680040079daed1d88cfdb74a922c59c81327133971ae5755ffe589152b2d9423a0dcd6b9540cb57a3146fdc256c573c26aa148a00ef28441b3c49ceedff190da2380ebc7bc19ef3082a195f47fdf453e0e0a54e10811b604df1d3c2238d4ec13ce0feb73216a7f100fa6eb7953f42858ef190aad1d271a5262aefb8d7ee6430061899695058feb51c914dc93a24dd1b5cf2b54334b385c54bc9b83748b966fda0d55d8da3324aa1ce4f835d44b379e785b0a95c7c9f7bae6df9cad098f40b0b159e416c5ed4d60950b40a30ecc0c125dbe6ff2cfcec7f8d36925d4252f276279c4d3680bd7180b991a320eba22c5d71079630deae6bf4f766da7cf62d6c410eb5f"
    # hmac_data_4 = "f6a9e85e5c6a0458c98282b786ffe8efb2f3f0e2cee0283a71aa4d873686d7efeac03dcb113fd91113df4bb5d5e8c13cde4bd12eced21d367381fdc31efe09695d6ecc095083c1571d10ed076ee914745479dfedcab84efd3889e6375f544562ea4a6522035738a9ba1a9ab4204339569d3d0c217324f1d5f3a107e930ade50b913777d1140096e2b26ce47486b66a6740f026ae91429115e17270c5a542b4c82ce438725060248726956e7639da64a55cec00b61719383271e0ab97dafe44ad194e7338ea841bf25a505d0041eb53dc0d0e6c3f7986f6647ede9327467212a3ca5724ece8503bfaba3800372d747abe2c174cbc2da01dd967fc0bae56d2bc7184e1d5d823661b8ff06eb466d483d6fa69a4f8b592ebc3006b7c047055b12407925ea74c2bb09ca21f4bc9d39dc4a7237ef6facbb15f5ba56d8e2ab94ad24267bf85cea55b0605cd6260b4b0f17994a03e39bebfcad0834849b188e83bf5c954dc112d33b0fada26f25d76d53ec9b95ed344059a279719d5edc953a4de2b1cc4f47d5da090c3b0f4c7eef14830f9a2230bffb722f11fd2ea82c43d58261e5a868361262abbd81b9f1e6145562ed6765aac732e7d91bfff7716509d72314d46904bcc8053cfd1e3cd7824b4b6499bf8c77762275fa4f651d163a8701f02a5ca67bb7d37787a66d269d4079aa92a489493020b11d87791a3e3ef66780bd0007c8fa2782bac7a839b57e8ace7618a75fe03604097960d2236616d579207fb943c85bef4f804e7f13d7d78ff3aab0f7f440a3005a363f32c31567b8d64669a7ae0299b06b80e4d224d2d70b80077ff966cfb8c11cf763954f398c592ca619acc2e0e86dad54b9cfa47bc10520f3c9ba2e0d2e27e0ba8ef8ece3e71c8a1ff75fe0c8369a3555e42db30565b2e12a8e862d0f873bd781ebf8255372e540bf6fbf4c1dae200823144f8da8df82ccd41b1b678eb91a289b88c6ee5aff71d98b64e8b17e2027fcb6826c418dbdb51f06bec866d69d9554931412808bd90021be2e0dad1d1ececfdd41fcdf6f67b88ef09eb9edcc4c226e07bdfe86b8e50e3bf68b19c0c9e0bf9aaaaddb15bc05a5666733789fa6efde866a49d0329185d852dc84a7e16c41f6c2daadc04665197152d9c0db63d0bd926c06bf3646b810186ae908a2f27a33d010b3262b0c0805c3adf135b41f15a033bb82a8db2c38160dbce672290878d7ad8d08fdd483ef9d95b3a1b2ea2b6ff0adde762e9df7b78fe5f3644df54c6d98709d70924ce6ec94650cb207b4f90d35569acb55811ad3f01b28bb2b16cfde454531b9462024abf419fb3bef80db9bb9fa5bd62a7e94f61a667e74140c8da4b27ad7b934c0824756fbc56f8ac7529fc4c5224158fd4915eba25a3f2a72a7f718a5cda6395bd8b2bc484a950aba483c8cadec376f9bee62c93f886d83371b41c361a36c15679ff933422e09c5eaf98d3c6b008cf6414ed6e4c42c291eb505e9f22f5fe7d0ecdd15a833f4d016ac974d33adc6ea3293e20859e87ebfb937ba406abd025d14af692b12e9c9c2adbe307a679779259676211c071e614fdb386d1ff02db223a5b2fae03df68d321c7b29f7c7240edd3fa1b7cb6903f89dc01abf41b2eb0b49b6b8d73bb0774b58204c0d0e96d3cce45ad75406be0bc009e327b3e712a4bd178609c00b41da2daf8a4b0e1319f07a492ab4efb056f0f599f75e6dc7e0d10ce1cf59088ab6e873de377343880f7a24f0e36731a0b72092f8d5bc8cd346762e93b2bf203d00264e4bc136fc142de8f7b69154deb05854ea88e2d7506222c95ba1aab065c8a851391377d3406a35a9af3ac4242424242424242424242424242424242424242424242424242424242424242"
    # hmac_4 = "9b122c79c8aee73ea2cdbc22eca15bbcc9409a4cdd73d2b3fcd4fe26a492d376"

    rhokey_3 = "cbe784ab745c13ff5cffc2fbe3e84424aa0fd669b8ead4ee562901a4a4e89e9e"
    mukey_3 = "5052aa1b3d9f0655a0932e50d42f0c9ba0705142c25d225515c45f47c0036ee9"
    # routing_info_3_unencrypted = "00030303030303030300000003000000030000000000000000000000000000000042c10947e06bda75b35ac2a9e38005479a6feac51468712e751c71a1dcf3e31bf6a9e85e5c6a0458c98282b786ffe8efb2f3f0e2cee0283a71aa4d873686d7efeac03dcb113fd91113df4bb5d5e8c13cde4bd12eced21d367381fdc31efe09695d6ecc095083c1571d10ed076ee914745479dfedcab84efd3889e6375f544562ea4a6522035738a9ba1a9ab4204339569d3d0c217324f1d5f3a107e930ade50b913777d1140096e2b26ce47486b66a6740f026ae91429115e17270c5a542b4c82ce438725060248726956e7639da64a55cec00b61719383271e0ab97dafe44ad194e7338ea841bf25a505d0041eb53dc0d0e6c3f7986f6647ede9327467212a3ca5724ece8503bfaba3800372d747abe2c174cbc2da01dd967fc0bae56d2bc7184e1d5d823661b8ff06eb466d483d6fa69a4f8b592ebc3006b7c047055b12407925ea74c2bb09ca21f4bc9d39dc4a7237ef6facbb15f5ba56d8e2ab94ad24267bf85cea55b0605cd6260b4b0f17994a03e39bebfcad0834849b188e83bf5c954dc112d33b0fada26f25d76d53ec9b95ed344059a279719d5edc953a4de2b1cc4f47d5da090c3b0f4c7eef14830f9a2230bffb722f11fd2ea82c43d58261e5a868361262abbd81b9f1e6145562ed6765aac732e7d91bfff7716509d72314d46904bcc8053cfd1e3cd7824b4b6499bf8c77762275fa4f651d163a8701f02a5ca67bb7d37787a66d269d4079aa92a489493020b11d87791a3e3ef66780bd0007c8fa2782bac7a839b57e8ace7618a75fe03604097960d2236616d579207fb943c85bef4f804e7f13d7d78ff3aab0f7f440a3005a363f32c31567b8d64669a7ae0299b06b80e4d224d2d70b80077ff966cfb8c11cf763954f398c592ca619acc2e0e86dad54b9cfa47bc10520f3c9ba2e0d2e27e0ba8ef8ece3e71c8a1ff75fe0c8369a3555e42db30565b2e12a8e862d0f873bd781ebf8255372e540bf6fbf4c1dae200823144f8da8df82ccd41b1b678eb91a289b88c6ee5aff71d98b64e8b17e2027fcb6826c418dbdb51f06bec866d69d9554931412808bd90021be2e0dad1d1ececfdd41fcdf6f67b88ef09eb9edcc4c226e07bdfe86b8e50e3bf68b19c0c9e0bf9aaaaddb15bc05a5666733789fa6efde866a49d0329185d852dc84a7e16c41f6c2daadc04665197152d9c0db63d0bd926c06bf3646b810186ae908a2f27a33d010b3262b0c0805c3adf135b41f15a033bb82a8db2c38160dbce672290878d7ad8d08fdd483ef9d95b3a1b2ea2b6ff0adde762e9df7b78fe5f3644df54c6d98709d70924ce6ec94650cb207b4f90d35569acb55811ad3f01b28bb2b16cfde454531b9462024abf419fb3bef80db9bb9fa5bd62a7e94f61a667e74140c8da4b27ad7b934c0824756fbc56f8ac7529fc4c5224158fd4915eba25a3f2a72a7f718a5cda6395bd8b2bc484a950aba483c8cadec376f9bee62c93f886d83371b41c361a36c15679ff933422e09c5eaf98d3c6b008cf6414ed6e4c42c291eb505e9f22f5fe7d0ecdd15a833f4d016ac974d33adc6ea3293e20859e87ebfb937ba406abd025d14af692b12e9c9c2adbe307a679779259676211c071e614fdb386d1ff02db223a5b2fae03df68d321c7b29f7c7240edd3fa1b7cb6903f89dc01abf41b2eb0b49b6b8d73bb0774b58204c0d0e96d3cce45ad75406be0bc009e327b3e712a4bd178609c00b41da2daf8a4b0e1319f07a492ab4efb056f0f599f75e6dc7e0d10ce1cf59088ab6e873de377343880f7a24f"
    routing_info_3_unencrypted = "00030303030303030300000000000000030000000300000000000000000000000062cc962876e734e089e79eda497077fb411fac5f36afd43329040ecd1e16c6d96ecc095083c1571d10ed076ee914745479dfedcab84efd3889e6375f544562ea4a6522035738a9ba1a9ab4204339569d3d0c217324f1d5f3a107e930ade50b913777d1140096e2b26ce47486b66a6740f026ae91429115e17270c5a542b4c82ce438725060248726956e7639da64a55cec00b61719383271e0ab97dafe44ad194e7338ea841bf25a505d0041eb53dc0d0e6c3f7986f6647ede9327467212a3ca5724ece8503bfaba3800372d747abe2c174cbc2da01dd967fc0bae56d2bc7184e1d5d823661b8ff06eb466d483d6fa69a4f8b592ebc3006b7c047055b12407925ea74c2bb09ca21f4bc9d39dc4a7237ef6facbb15f5ba56d8e2ab94ad24267bf85cea55b0605cd6260b4b0f17994a03e39bebfcad0834849b188e83bf5c954dc112d33b0fada26f25d76d53ec9b95ed344059a279719d5edc953a4de2b1cc4f47d5da090c3b0f4c7eef14830f9a2230bffb722f11fd2ea82c43d58261e5a868361262abbd81b9f1e6145562ed6765aac732e7d91bfff7716509d72314d46904bcc8053cfd1e3cd7824b4b6499bf8c77762275fa4f651d163a8701f02a5ca67bb7d37787a66d269d4079aa92a489493020b11d87791a3e3ef66780bd0007c8fa2782bac7a839b57e8ace7618a75fe03604097960d2236616d579207fb943c85bef4f804e7f13d7d78ff3aab0f7f440a3005a363f32c31567b8d64669a7ae0299b06b80e4d224d2d70b80077ff966cfb8c11cf763954f398c592ca619acc2e0e86dad54b9cfa47bc10520f3c9ba2e0d2e27e0ba8ef8ece3e71c8a1ff75fe0c8369a3555e42db30565b2e12a8e862d0f873bd781ebf8255372e540bf6fbf4c1dae200823144f8da8df82ccd41b1b678eb91a289b88c6ee5aff71d98b64e8b17e2027fcb6826c418dbdb51f06bec866d69d9554931412808bd90021be2e0dad1d1ececfdd41fcdf6f67b88ef09eb9edcc4c226e07bdfe86b8e50e3bf68b19c0c9e0bf9aaaaddb15bc05a5666733789fa6efde866a49d0329185d852dc84a7e16c41f6c2daadc04665197152d9c0db63d0bd926c06bf3646b810186ae908a2f27a33d010b3262b0c0805c3adf135b41f15a033bb82a8db2c38160dbce672290878d7ad8d08fdd483ef9d95b3a1b2ea2b6ff0adde762e9df7b78fe5f3644df54c6d98709d70924ce6ec94650cb207b4f90d35569acb55811ad3f01b28bb2b16cfde454531b9462024abf419fb3bef80db9bb9fa5bd62a7e94f61a667e74140c8da4b27ad7b934c0824756fbc56f8ac7529fc4c5224158fd4915eba25a3f2a72a7f718a5cda6395bd8b2bc484a950aba483c8cadec376f9bee62c93f886d83371b41c361a36c15679ff933422e09c5eaf98d3c6b008cf6414ed6e4c42c291eb505e9f22f5fe7d0ecdd15a833f4d016ac974d33adc6ea3293e20859e87ebfb937ba406abd025d14af692b12e9c9c2adbe307a679779259676211c071e614fdb386d1ff02db223a5b2fae03df68d321c7b29f7c7240edd3fa1b7cb6903f89dc01abf41b2eb0b49b6b8d73bb0774b58204c0d0e96d3cce45ad75406be0bc009e327b3e712a4bd178609c00b41da2daf8a4b0e1319f07a492ab4efb056f0f599f75e6dc7e0d10ce1cf59088ab6e873de377343880f7a24f0e36731a0b72092f8d5bc8cd346762e93b2bf203d00264e4bc136fc142de8f7b69154deb05854ea88e2d7506222c95ba1aab065c8a851391377d3406a35a9af3ac"
    # routing_info_3_encrypted = "35dd8ba6f4e53e2f0372992045827fc994c3312b54591844fc713c0cca433626a09629ccb8c0e8f28648628269f29e8bcd5941429852a5e34fdfe080f74b0f19ffaf3e17e529ce3c0c58316f255e42848df14bce0781a4653c84ac8f58bf89671cd0d4b692e9e42584a52509e03f8769bb4ef6a0f6f4002c81011da7f5f9a8da9b19bd25cb25aeb3873c5fa95396b56900847794a97935e542637ef5f42f088c6e24e8e95de7be71d110872c84a60a53bbd789f3a58c1072c5fbb84192dd5f780deb14bdbbf458be297eb3244499a7921db98912625c88350cb29e71ca8d788bfb9bd11146e48659b0d86afe13b47685ec49d36e57292d819442ba516d365be31e7980c0e7b14f40807393b1391d9b83c30191d4bfe49c143da2848d2d7bfd54c32bdfdaefcd4cb84ea895e2305745d2ae257b0414563224af66f3b25d3d451bdd8331670e9dcac78b0690c4ae849d0bd8e956dbc56b5a8114008e9dc54f1252544a45861521efd6376b6c0fb34c1c433b677c08d6bf5356e81772bfeed5a894b590859cd409dedd1cd9881c3b8caed81d4d8d834dbd3e870a39e69d6a1ce2dc15df8f8c34d64d292b0b99bf17bb92b263176b65634dc8f368cf7b558fef5b259964f42ec94eeac74d0abd829baa9b04f89ea3606074a4aace03e7f2217f2dec855f4028392f64f0baddd178d56d84cab16c8484633f7c5e8e7f8651ce8a7f5ce1ca3a966562a0a2a7247d105a3114ab2adbd10cfd70b2765113c42e4d1cbcb8721a719f46b25d8579a670be085d1afd2d2e541c4a27bdfffe49674798cf690f28bf4f58ec1495561be071d1c94156f15c95f3426a7409680ef8cf335a0d4786bbb0bf108589c3c8baf10f04dc7f8beda2f70117f28c771a83890d4e1c47903d642fef8a93a216576f377db3ad5be3abe7eaa924e1e7de9ac88e07177e57cad41ef5a561f6bdb741961eddee56f3d9aef9fc4e52343f2efda3a2d40b8d2b4afa735cd5655d3014d21b41eba3a8cf34a8c29cbf94dfb9a4312ee0851c6e32896b33d52d991560e3ae97c769071453a4969374aecf7423f07ee17ce71111dc925294b0130249ad00d49e26dbfddcaf214dc8356cee3a0d7486fa6144c6c826be0892ceea30e52d7b64a13b08eda3e991f37e210ccd216108c847adb58df3b2a53553689f5119e41b4f4f221474c21e197d8a13e9cf7cf23875a0dbc6ddaeca9eb6d95add2a0054528d9dc03d59bc108157291b4caa0faa53f2511bec3088a164a0768d38d7fe3281ea8459abbe3a5b5f43c697e5cbdc995832220a3c6fcf1e82bd35f4b94b13cc9312efc3ca4e3c8199e862c551fa7916e3cb0ad17ba24e456fcd2159f9e81628c508da4c2de4825100fee1c3226d1d431a740d2d8ab0c04953b073d9a20919e0f2d03e97b3f34a1644cbeeab7d0c78d898e8c523fbccc75ffc329fafe45288e21c82817e23589d0c6db453be7d3f8ecfa0ae1d24ae80c63511193c718195255a576c1b43c8d941ba22f6d9f743a7dd558e08ac2262fd67056d60e837edd3e21ce23ef27d48c9180d845ce8c5d6d4c488fcf55af99aef02f3bdf6a07833660628a672b878f8b15427189e49bf2d9e0e7e63e3c5632d9ef1e412e9bbd732b616a353097e90494a098df6a21729f1d3658f91b1bde4aaaae58530ab0e402fc10eb0910c07cace1afd0aacb579690e6dcbc184025e4160cf4de3e47106339046724d098b5b7b92f5a2bb33c11f86d4953f372fdd9ebc260b0ee2e391420c4b11145bd439954834d9a79e78abc57e03d3ee20d239d8a13014976e3f057ab3c38ca79ee81ff8849d94dca37b0920cc3e72"
    routing_info_3_encrypted = "35dd8ba6f4e53e2f0372992046827fc994c3312b57591844fc713c0cca433626a0b62453d756641c1372dfde1a586ef971823104027062465283f8ff9b89ea3c3d375bf6ebf6656f49815eeafc31a918363a67d32ff70ab03e7ce0f580dd4ad2197071a95aafe3552fac60f675a956fe1aadb150ab1e23e444d39bb3064ab3d86373a438d675bb90624dab30d24e361a342028e5d5f11cbe5e2987d66632e801202a9afe2f84cdce5e3ff3c0095c2dcfb1a6b44993e60cb161e8b2d1a113b6301f3450f2806443da919c82c071f4422477f7150bb54b3cc0678d7f26495a289cf9e011c5dce4dd878dc6ffa748f9d65f650273d2cc9e2960c1cf5154ac3e19d637811b6bfc3dd0d48247778aeddfa62a76a8670d1276d9e232a05e6e5f8cab41f2bf2fb228958021ab5964319abe968b6eff96831924c99c1b8f2500b9b9d5c013821e178db8a91166964ac039298a7d1cb94c9cba29320a5dda7a718eef6a228fc93612e9f0856c672951135e1861bacb5d8f683a9915d8a0b3af3189b4661226525df2e191682c165519e0bb84756fb68c031f03683ceec0b46a4da4394d93c262b88bbcbeac6c1398819fec532d5191b7011d68d5a09dab722f741a7c36a9165c0920a60fcabac1e9e7c59a019a61acf77b88e673eaa9472953d07bfcf9d1b8a1167669f26e82f1c42a94a90bc62fe9cbe672693f6042160faec76cbb4e95d3f9ddba4c2eea1682f0bec5660d71508dec24bdaff67246ed27fe59a98a25f7ab55f4acd939062a688d4d8fae0816638e29fc6e617c1d0a662b65590965895a3c1b8f7d0d4c5be03cb0dd41575d4ff4d3e47ca3c52dd8c6aa0752c0c73afdb4b8d49ea31d947549d7dbff02ecd2147b4ab90f1c7ef19515a43a21d50f23e65e2417bc6cdf34044c1969d71b32c6a53f6fdbc0f5285cdf5e7e1f9e2be439c720f273fd85f9d9978bd22242a0dbde03a5babcb9e110be459c6ace841c3cd5a314f24abd5825b6d739964b35daeca13b11e3ba4bdd802e2ed989cccaf57813ac7b05dbd0cf3be9ed8261b7aac3be7cce2abac3ec3d1347f5151e6845e1160e15db7d4bc663fc3a9f0c1fabec7e80ca5d4e5c045f03964f75961a746b1560b8721d5c4e2b67ed36d0c3c055ad9ea7b4322463c5ea46a9da8b22c87bf8a2112c1e9af0626dc9d1896a94d3429d01ea6861dde7d5b98355ddf8ddd85d8d974410672d679d618877c06812150c126f0ebf8195281f8d088d864ce12e455cdac77f8d5e52b9eed5e89e5fe342555a41524f8e61c9fd72c6ae0547cea2d86c131950efdeecdd7a0ffe139193578522cadfa282e5026a317fbc1673d1d448c3d54a52e140df738bac53042f137cb62bd70e5f66927ec46fd427cf9a8788099bc9d5d2403c1dd12b71183f7bb1455285105f4acaba9fea1bc7e3c1978b377d1af3b56e80f4e2927fe84dd7eb35c0337f923b0f804e694227d4ff5499510fdc49b2dfc265f96f0e233248023bbdb3b801717bd8f2a62be1f3c78292106b1e3671802c4db8d25fd1d23469bc09704fd5f6035fb02c624274f4856c8ef9d84553ccd0209e3c573d81e4a22009c5a03d9314dd92ff4e96e8c51c23574c2175d0c223a90bdc9d5693cc5608ac64d620c8ca60542796c54cdc6c4804919db3cb9d294c202a4d880bdb09259b5477be1619b77c31787dff1b9a1cea12b375647b87de06d9e40493fb100deeee1cb60c538efbdba3578bcb910149a7554ce940968755b586cb18559b5444e9fb47c94be9233172bf4c5509082a6e7f1e69c677c7588097c3256edffb282b6958106d241dd6f98b9e42e04992faa16f91"
    # hmac_data_3 = "35dd8ba6f4e53e2f0372992045827fc994c3312b54591844fc713c0cca433626a09629ccb8c0e8f28648628269f29e8bcd5941429852a5e34fdfe080f74b0f19ffaf3e17e529ce3c0c58316f255e42848df14bce0781a4653c84ac8f58bf89671cd0d4b692e9e42584a52509e03f8769bb4ef6a0f6f4002c81011da7f5f9a8da9b19bd25cb25aeb3873c5fa95396b56900847794a97935e542637ef5f42f088c6e24e8e95de7be71d110872c84a60a53bbd789f3a58c1072c5fbb84192dd5f780deb14bdbbf458be297eb3244499a7921db98912625c88350cb29e71ca8d788bfb9bd11146e48659b0d86afe13b47685ec49d36e57292d819442ba516d365be31e7980c0e7b14f40807393b1391d9b83c30191d4bfe49c143da2848d2d7bfd54c32bdfdaefcd4cb84ea895e2305745d2ae257b0414563224af66f3b25d3d451bdd8331670e9dcac78b0690c4ae849d0bd8e956dbc56b5a8114008e9dc54f1252544a45861521efd6376b6c0fb34c1c433b677c08d6bf5356e81772bfeed5a894b590859cd409dedd1cd9881c3b8caed81d4d8d834dbd3e870a39e69d6a1ce2dc15df8f8c34d64d292b0b99bf17bb92b263176b65634dc8f368cf7b558fef5b259964f42ec94eeac74d0abd829baa9b04f89ea3606074a4aace03e7f2217f2dec855f4028392f64f0baddd178d56d84cab16c8484633f7c5e8e7f8651ce8a7f5ce1ca3a966562a0a2a7247d105a3114ab2adbd10cfd70b2765113c42e4d1cbcb8721a719f46b25d8579a670be085d1afd2d2e541c4a27bdfffe49674798cf690f28bf4f58ec1495561be071d1c94156f15c95f3426a7409680ef8cf335a0d4786bbb0bf108589c3c8baf10f04dc7f8beda2f70117f28c771a83890d4e1c47903d642fef8a93a216576f377db3ad5be3abe7eaa924e1e7de9ac88e07177e57cad41ef5a561f6bdb741961eddee56f3d9aef9fc4e52343f2efda3a2d40b8d2b4afa735cd5655d3014d21b41eba3a8cf34a8c29cbf94dfb9a4312ee0851c6e32896b33d52d991560e3ae97c769071453a4969374aecf7423f07ee17ce71111dc925294b0130249ad00d49e26dbfddcaf214dc8356cee3a0d7486fa6144c6c826be0892ceea30e52d7b64a13b08eda3e991f37e210ccd216108c847adb58df3b2a53553689f5119e41b4f4f221474c21e197d8a13e9cf7cf23875a0dbc6ddaeca9eb6d95add2a0054528d9dc03d59bc108157291b4caa0faa53f2511bec3088a164a0768d38d7fe3281ea8459abbe3a5b5f43c697e5cbdc995832220a3c6fcf1e82bd35f4b94b13cc9312efc3ca4e3c8199e862c551fa7916e3cb0ad17ba24e456fcd2159f9e81628c508da4c2de4825100fee1c3226d1d431a740d2d8ab0c04953b073d9a20919e0f2d03e97b3f34a1644cbeeab7d0c78d898e8c523fbccc75ffc329fafe45288e21c82817e23589d0c6db453be7d3f8ecfa0ae1d24ae80c63511193c718195255a576c1b43c8d941ba22f6d9f743a7dd558e08ac2262fd67056d60e837edd3e21ce23ef27d48c9180d845ce8c5d6d4c488fcf55af99aef02f3bdf6a07833660628a672b878f8b15427189e49bf2d9e0e7e63e3c5632d9ef1e412e9bbd732b616a353097e90494a098df6a21729f1d3658f91b1bde4aaaae58530ab0e402fc10eb0910c07cace1afd0aacb579690e6dcbc184025e4160cf4de3e47106339046724d098b5b7b92f5a2bb33c11f86d4953f372fdd9ebc260b0ee2e391420c4b11145bd439954834d9a79e78abc57e03d3ee20d239d8a13014976e3f057ab3c38ca79ee81ff8849d94dca37b0920cc3e724242424242424242424242424242424242424242424242424242424242424242"
    # hmac_3 = "548e58057ab0a0e6c2d8ad8e855d89f9224279a5652895ea14f60bffb81590eb"

    rhokey_2 = "11bf5c4f960239cb37833936aa3d02cea82c0f39fd35f566109c41f9eac8deea"
    mukey_2 = "caafe2820fa00eb2eeb78695ae452eba38f5a53ed6d53518c5c6edf76f3f5b78"
    # routing_info_2_unencrypted = "0002020202020202020000000200000002000000000000000000000000000000004e888d0cc6a90e7f857af18ac858834ac251d0d1c196d198df48a0c5bf81680335dd8ba6f4e53e2f0372992045827fc994c3312b54591844fc713c0cca433626a09629ccb8c0e8f28648628269f29e8bcd5941429852a5e34fdfe080f74b0f19ffaf3e17e529ce3c0c58316f255e42848df14bce0781a4653c84ac8f58bf89671cd0d4b692e9e42584a52509e03f8769bb4ef6a0f6f4002c81011da7f5f9a8da9b19bd25cb25aeb3873c5fa95396b56900847794a97935e542637ef5f42f088c6e24e8e95de7be71d110872c84a60a53bbd789f3a58c1072c5fbb84192dd5f780deb14bdbbf458be297eb3244499a7921db98912625c88350cb29e71ca8d788bfb9bd11146e48659b0d86afe13b47685ec49d36e57292d819442ba516d365be31e7980c0e7b14f40807393b1391d9b83c30191d4bfe49c143da2848d2d7bfd54c32bdfdaefcd4cb84ea895e2305745d2ae257b0414563224af66f3b25d3d451bdd8331670e9dcac78b0690c4ae849d0bd8e956dbc56b5a8114008e9dc54f1252544a45861521efd6376b6c0fb34c1c433b677c08d6bf5356e81772bfeed5a894b590859cd409dedd1cd9881c3b8caed81d4d8d834dbd3e870a39e69d6a1ce2dc15df8f8c34d64d292b0b99bf17bb92b263176b65634dc8f368cf7b558fef5b259964f42ec94eeac74d0abd829baa9b04f89ea3606074a4aace03e7f2217f2dec855f4028392f64f0baddd178d56d84cab16c8484633f7c5e8e7f8651ce8a7f5ce1ca3a966562a0a2a7247d105a3114ab2adbd10cfd70b2765113c42e4d1cbcb8721a719f46b25d8579a670be085d1afd2d2e541c4a27bdfffe49674798cf690f28bf4f58ec1495561be071d1c94156f15c95f3426a7409680ef8cf335a0d4786bbb0bf108589c3c8baf10f04dc7f8beda2f70117f28c771a83890d4e1c47903d642fef8a93a216576f377db3ad5be3abe7eaa924e1e7de9ac88e07177e57cad41ef5a561f6bdb741961eddee56f3d9aef9fc4e52343f2efda3a2d40b8d2b4afa735cd5655d3014d21b41eba3a8cf34a8c29cbf94dfb9a4312ee0851c6e32896b33d52d991560e3ae97c769071453a4969374aecf7423f07ee17ce71111dc925294b0130249ad00d49e26dbfddcaf214dc8356cee3a0d7486fa6144c6c826be0892ceea30e52d7b64a13b08eda3e991f37e210ccd216108c847adb58df3b2a53553689f5119e41b4f4f221474c21e197d8a13e9cf7cf23875a0dbc6ddaeca9eb6d95add2a0054528d9dc03d59bc108157291b4caa0faa53f2511bec3088a164a0768d38d7fe3281ea8459abbe3a5b5f43c697e5cbdc995832220a3c6fcf1e82bd35f4b94b13cc9312efc3ca4e3c8199e862c551fa7916e3cb0ad17ba24e456fcd2159f9e81628c508da4c2de4825100fee1c3226d1d431a740d2d8ab0c04953b073d9a20919e0f2d03e97b3f34a1644cbeeab7d0c78d898e8c523fbccc75ffc329fafe45288e21c82817e23589d0c6db453be7d3f8ecfa0ae1d24ae80c63511193c718195255a576c1b43c8d941ba22f6d9f743a7dd558e08ac2262fd67056d60e837edd3e21ce23ef27d48c9180d845ce8c5d6d4c488fcf55af99aef02f3bdf6a07833660628a672b878f8b15427189e49bf2d9e0e7e63e3c5632d9ef1e412e9bbd732b616a353097e90494a098df6a21729f1d3658f91b1bde4aaaae58530ab0e402fc10eb0910c07cace1afd0aacb579690e6dcbc184025e4160cf4de3e47106339046724d098b5b7b92f5a2bb33c11f86d4"
    routing_info_2_unencrypted = "000202020202020202000000000000000200000002000000000000000000000000cf02d2f131d215cb309527141983a72f60296dc5605e3164ba0701be5a903e61375bf6ebf6656f49815eeafc31a918363a67d32ff70ab03e7ce0f580dd4ad2197071a95aafe3552fac60f675a956fe1aadb150ab1e23e444d39bb3064ab3d86373a438d675bb90624dab30d24e361a342028e5d5f11cbe5e2987d66632e801202a9afe2f84cdce5e3ff3c0095c2dcfb1a6b44993e60cb161e8b2d1a113b6301f3450f2806443da919c82c071f4422477f7150bb54b3cc0678d7f26495a289cf9e011c5dce4dd878dc6ffa748f9d65f650273d2cc9e2960c1cf5154ac3e19d637811b6bfc3dd0d48247778aeddfa62a76a8670d1276d9e232a05e6e5f8cab41f2bf2fb228958021ab5964319abe968b6eff96831924c99c1b8f2500b9b9d5c013821e178db8a91166964ac039298a7d1cb94c9cba29320a5dda7a718eef6a228fc93612e9f0856c672951135e1861bacb5d8f683a9915d8a0b3af3189b4661226525df2e191682c165519e0bb84756fb68c031f03683ceec0b46a4da4394d93c262b88bbcbeac6c1398819fec532d5191b7011d68d5a09dab722f741a7c36a9165c0920a60fcabac1e9e7c59a019a61acf77b88e673eaa9472953d07bfcf9d1b8a1167669f26e82f1c42a94a90bc62fe9cbe672693f6042160faec76cbb4e95d3f9ddba4c2eea1682f0bec5660d71508dec24bdaff67246ed27fe59a98a25f7ab55f4acd939062a688d4d8fae0816638e29fc6e617c1d0a662b65590965895a3c1b8f7d0d4c5be03cb0dd41575d4ff4d3e47ca3c52dd8c6aa0752c0c73afdb4b8d49ea31d947549d7dbff02ecd2147b4ab90f1c7ef19515a43a21d50f23e65e2417bc6cdf34044c1969d71b32c6a53f6fdbc0f5285cdf5e7e1f9e2be439c720f273fd85f9d9978bd22242a0dbde03a5babcb9e110be459c6ace841c3cd5a314f24abd5825b6d739964b35daeca13b11e3ba4bdd802e2ed989cccaf57813ac7b05dbd0cf3be9ed8261b7aac3be7cce2abac3ec3d1347f5151e6845e1160e15db7d4bc663fc3a9f0c1fabec7e80ca5d4e5c045f03964f75961a746b1560b8721d5c4e2b67ed36d0c3c055ad9ea7b4322463c5ea46a9da8b22c87bf8a2112c1e9af0626dc9d1896a94d3429d01ea6861dde7d5b98355ddf8ddd85d8d974410672d679d618877c06812150c126f0ebf8195281f8d088d864ce12e455cdac77f8d5e52b9eed5e89e5fe342555a41524f8e61c9fd72c6ae0547cea2d86c131950efdeecdd7a0ffe139193578522cadfa282e5026a317fbc1673d1d448c3d54a52e140df738bac53042f137cb62bd70e5f66927ec46fd427cf9a8788099bc9d5d2403c1dd12b71183f7bb1455285105f4acaba9fea1bc7e3c1978b377d1af3b56e80f4e2927fe84dd7eb35c0337f923b0f804e694227d4ff5499510fdc49b2dfc265f96f0e233248023bbdb3b801717bd8f2a62be1f3c78292106b1e3671802c4db8d25fd1d23469bc09704fd5f6035fb02c624274f4856c8ef9d84553ccd0209e3c573d81e4a22009c5a03d9314dd92ff4e96e8c51c23574c2175d0c223a90bdc9d5693cc5608ac64d620c8ca60542796c54cdc6c4804919db3cb9d294c202a4d880bdb09259b5477be1619b77c31787dff1b9a1cea12b375647b87de06d9e40493fb100deeee1cb60c538efbdba3578bcb910149a7554ce940968755b586cb18559b5444e9fb47c94be9233172bf4c5509082a6e7f1e69c677c7588097c3256edffb282b6958106d241dd6f98b9e42e04992faa16f91"
    # routing_info_2_encrypted = "e22ca641baa077154733abc586fae578ea0ed4c1851d0554235171e45e1e2a1868352b14951972fbeec9ffa500e74d24fd6d3b925c191c3454b97f518d68585db436277ec6404d85da476af5cfbfe7a392d4b8c931b57629c04ff70c08e51fa8d73e8ef55fd23b09430d4807dbdc4a7419c97b2e46d0568ca77526944e7c6a615475faea10de1025016f6fcb6f685ebdaf55c7908fd926f531d27e206307f7c9086355a351298fd6ed1f05d8724a6b159f52ed4cb988cde07f1d0eb0384803511b480ed31a1ecb7320bbd98da168ae64de73347d59df8ed0588aba661dc2d0bba2bc74ac0d2c479f466ee73def4a32cd806b0966b8f535e742c6a907af0f3dad003016db95194d381109c53499efcf4d868677c3a6dc4a184eccc2198aec260673a801814e60405670f557e618bb3b5df1e51cc90d995d0832b307c102b3fd1d083f52794ccb5a185885280dbd9e36ce64ddf320b6a7e340180e4f525c682bcd1f9cfa3ae5bbd8cdbd83e3d291e98606a7890bd8abbcf57aea1492fc1d6c876cad86446fc85b2db47ff2c6ea384fdda8bc53e81152687a702318c91f657253403612393ec7f864ddf5e807497cb88816f736f08a593d8d1e2c46c13675de2b2aa8c383b8610a5c772bbcf831e426f750c6358e623d9938890aa1d70297c4e4d238b14967f48da074ca469212336a77a2fe0fc80dc2ecd59a2ca389440cb2c1f9835786ad7e1f5bf3ceb27c8abe10178bffcbd888a9b31b9b9a5e308cefe00bdc25c82597dc22ff814b4dcb717be6ec6d87cf25dbb9fde6726461d504d4b9707d708238415ca3dc6e86d3738b902ff4a449597fcac06757fd97e0fe52c1addf7b34731366e2a5694883c60f4c9676ea6167a9fbf8b7d64932676e11fd38f7338e8954236ae31dbd7e2732d74a16b4d0809229ce44e696ceb383c41375ea0e40686f4e0c3967fa22a9e8a2ebb637816c8d1875edf86b1a4998b8525708a027a57852e28e7e84ab3d0db6b73b7e6775604d317139bc0146fedf45a17bc8b3559d4921cb87c51a21f374e040da55e013f4748b22e58f3a53f8ba733bf823eec2f2e8250d3584bd0719bdc36c1f411bfc3d6baf0db966ff2f60dc348da8ed5d011634677ff04c705b6a6942eaffbea4dc0ff5451083f5f7117df044b868df8ae2291ee68998f4c159e885ebcd1073f751899557546e5d8ddbee87a5747e5fa3f5610adf7dece55a339276e7efc3d9a152f222dd3f0452ee4ec56af7a5c1f3b9130ccf1c689e8e1401e8b885ca67349b69526ff523f217c3b36c643a9c46c46b0dc2d0f1d80c83435f752740ee7e423a59badfd5981706ec62d38ce07295ef4fbe23a4ab6cf85a2289e09cc5ad0bae981d3f42e9c6c85eeaff1f257e8ab99c2e93754e88ccd23fe3ad9c78be182b3944b79877aa1eced48b8fcf1f51c5cd01c4b2b111c97f0338e0efccc61e728e784c51d50371f453d926b02fae5c46e118a2f23a28d6f0830ec04b736ed84cf09ea1b0e228d13d7c8794ae6f363d100538a9baa9fbe533a909717dcce4c012d7f258aaee4b41c2e3f1bfe44a652ba8da51dc67164c43112805d474372b9076f3f3f0e7af94604f4fcddd2136dd7dc80ce3ff845924462cf52f5818aebf3b64f38f98edf8cb9c460477a2f94b891573929c4b51deafe6db81bc30680f7226a68567588f195ce96a791e28204b9b5844c28a61736ac20722fe156175210c7b9b6e1804c89c0a7ee136597b5b3de5d54be23671bc9477805ba10d03afb0715782845d2ab45df012f6644207cc5fa4739aa3eaf6bf84e790128aa08aede33bf30c6be2b264b33fac566209"
    routing_info_2_encrypted = "e22ca641baa077154733abc584fae578ea0ed4c1871d0554235171e45e1e2a1868b4a14b68ee09e05a7c10739e36960098cf432f48b8d4d4a8dc30f0f68d490bd634a1038b42cdd4bcc5468613cbccc46d7a1c2b35162581bacf66c584f2164ce8ee6975c9c518b49e2760932c1cee1488a9933faf5627cd00e962c7c8c192b62ef9f1ecd14e827b5f2e9ccad20336e51ff81e3e942fbbef0ac77d5a8a6da0414f551f89c83fabfc96a4533d72f6795d474f17f38a9835513274bd7c3eae4cc9dee7479cbfb1ad0702a0671279cf7af5c084a501783dcb25da45a63ea16cd72fd732418138957da6ba79081d8b374298b6d2ad3d87ce9097f1cc03eb42a3f9244fbce6a4d49f69b42d67cc0d5074f0c06233a947a6c8cf7249602ee9a4aa003f0aecb5e277b324f1821cebbd7c1619a01af6c3997aeabdb9a8a8607bea671e86f8a335ee019442467e93115e358ea128fba7be2dd83135d651e997a75faa3a12c496e7f7d6a490ed62e41a542dc1b0f9be7aa1cb9531b6906e085b3e2685dc3b90099aac4ec4d852ae2cd99a47652c5a010702588ac52dc462b8a3dc5c8e51c1a624cbf0fd53e95e3047edba9f58e95b25ba96eb393e92d0d1dcf930d04cc82b2a2a1a1d5bd19f133749c67c621ce19fb2dfb86758a76f1eca82bd34715201e15c05809e114b18bb12a9b31f25760a1fa5a73914ceb0f810c9c4e8f83586603775373fe31cf8ff0f8b0fc8f25a86cc4076df629666251d79ddb7cd32b44b510662188e7b2d22d6cfd37a5b2fad3b978ac357b5315ce2c4045cc4cfdb8c12735810787d06c78ae52e18c48ab7d7288a443197d8b809b7ff894bb6bf5628da3e7334d597b46077ae5cd164563ec4aca300d03ddab0d56dfb9a3caa794f704c1ab9a26b204964c5ada76840e020f5bb34e90cae9b428ca065e495d575913d6d8a0f1b8641038ea63ce1f23a5819e88310a34f6ba3186c568073c81f5a19d2ee41fc9dcc1cc92b8e4822779339d9387900bf792c98c8a58937d856a53f3adc3866f8f00ea2af403ea341c0616e4bb039c9879f18f5fc7b20328190f01f16f341cc79a235af322460b6a50edcb2d4389eaf115bcb7adafdbfacee1fd7237d21d756a050020e060478da492c289549047c6e75b0461d1d91bfd522f222ec9a8adfeb16447f452e12992f11ec11aba9e0e54769fd49e2b2363c1b2efbd3928c212d2099b07243871d16d71f9642eabe424e9a26065ea856aee9e88311a7309cf39f33347b8218c4ad86534088d01f61bde4c21741549338a2cad992ede4f111aff3e790abdc2c51974cb0e69af69cb5bc4728bb80db3d35fa7b0a0ec66b4dd635646380d469fecea673fd0e539f79d22878028fd4c4306f06ec1cfac4a12869948e2bf028280df7b0812b5ae9a56de355c1d354dd96104292374e77adb20689d392748ae6cc2529452e0f36d69bbdc793dc044de657b72fb4f9f5e527978520cdf01682098d799e8150a821bbca665c292206ca3132243d1a44a7c5cbe3574349304ed5887dd4d94a4927880d465fd25f87ce44b7e5a909ece47c1dc0e6322f7c3f1f0a67acbd266158a8dcc1fea4e6bb595b207e53a4ad2db04226a5a60d28093fc11fb50894ca279e647dcd5cee93766330031cc289a5e7a070be7d0027268e1ea519cb72dc14021999c24da981ae91a6c15fed3f2c21055b51833c5fa77e1b861d2bfe94c7c9cbd58e0cfc1e25f2194ada6dddbfb8fde4d7f2e2e3a3b31a104144dc7f1108d985684b0978b43c2c7c1c5e548de1725203c1e9e7294475491c9cb8f8c93fd068dcf28a2faeae9bee0526419e97e88b4c"
    # hmac_data_2 = "e22ca641baa077154733abc586fae578ea0ed4c1851d0554235171e45e1e2a1868352b14951972fbeec9ffa500e74d24fd6d3b925c191c3454b97f518d68585db436277ec6404d85da476af5cfbfe7a392d4b8c931b57629c04ff70c08e51fa8d73e8ef55fd23b09430d4807dbdc4a7419c97b2e46d0568ca77526944e7c6a615475faea10de1025016f6fcb6f685ebdaf55c7908fd926f531d27e206307f7c9086355a351298fd6ed1f05d8724a6b159f52ed4cb988cde07f1d0eb0384803511b480ed31a1ecb7320bbd98da168ae64de73347d59df8ed0588aba661dc2d0bba2bc74ac0d2c479f466ee73def4a32cd806b0966b8f535e742c6a907af0f3dad003016db95194d381109c53499efcf4d868677c3a6dc4a184eccc2198aec260673a801814e60405670f557e618bb3b5df1e51cc90d995d0832b307c102b3fd1d083f52794ccb5a185885280dbd9e36ce64ddf320b6a7e340180e4f525c682bcd1f9cfa3ae5bbd8cdbd83e3d291e98606a7890bd8abbcf57aea1492fc1d6c876cad86446fc85b2db47ff2c6ea384fdda8bc53e81152687a702318c91f657253403612393ec7f864ddf5e807497cb88816f736f08a593d8d1e2c46c13675de2b2aa8c383b8610a5c772bbcf831e426f750c6358e623d9938890aa1d70297c4e4d238b14967f48da074ca469212336a77a2fe0fc80dc2ecd59a2ca389440cb2c1f9835786ad7e1f5bf3ceb27c8abe10178bffcbd888a9b31b9b9a5e308cefe00bdc25c82597dc22ff814b4dcb717be6ec6d87cf25dbb9fde6726461d504d4b9707d708238415ca3dc6e86d3738b902ff4a449597fcac06757fd97e0fe52c1addf7b34731366e2a5694883c60f4c9676ea6167a9fbf8b7d64932676e11fd38f7338e8954236ae31dbd7e2732d74a16b4d0809229ce44e696ceb383c41375ea0e40686f4e0c3967fa22a9e8a2ebb637816c8d1875edf86b1a4998b8525708a027a57852e28e7e84ab3d0db6b73b7e6775604d317139bc0146fedf45a17bc8b3559d4921cb87c51a21f374e040da55e013f4748b22e58f3a53f8ba733bf823eec2f2e8250d3584bd0719bdc36c1f411bfc3d6baf0db966ff2f60dc348da8ed5d011634677ff04c705b6a6942eaffbea4dc0ff5451083f5f7117df044b868df8ae2291ee68998f4c159e885ebcd1073f751899557546e5d8ddbee87a5747e5fa3f5610adf7dece55a339276e7efc3d9a152f222dd3f0452ee4ec56af7a5c1f3b9130ccf1c689e8e1401e8b885ca67349b69526ff523f217c3b36c643a9c46c46b0dc2d0f1d80c83435f752740ee7e423a59badfd5981706ec62d38ce07295ef4fbe23a4ab6cf85a2289e09cc5ad0bae981d3f42e9c6c85eeaff1f257e8ab99c2e93754e88ccd23fe3ad9c78be182b3944b79877aa1eced48b8fcf1f51c5cd01c4b2b111c97f0338e0efccc61e728e784c51d50371f453d926b02fae5c46e118a2f23a28d6f0830ec04b736ed84cf09ea1b0e228d13d7c8794ae6f363d100538a9baa9fbe533a909717dcce4c012d7f258aaee4b41c2e3f1bfe44a652ba8da51dc67164c43112805d474372b9076f3f3f0e7af94604f4fcddd2136dd7dc80ce3ff845924462cf52f5818aebf3b64f38f98edf8cb9c460477a2f94b891573929c4b51deafe6db81bc30680f7226a68567588f195ce96a791e28204b9b5844c28a61736ac20722fe156175210c7b9b6e1804c89c0a7ee136597b5b3de5d54be23671bc9477805ba10d03afb0715782845d2ab45df012f6644207cc5fa4739aa3eaf6bf84e790128aa08aede33bf30c6be2b264b33fac5662094242424242424242424242424242424242424242424242424242424242424242"
    # hmac_2 = "28430b210c0af631ef80dc8594c08557ce4626bdd3593314624a588cc083a1d9"

    rhokey_1 = "450ffcabc6449094918ebe13d4f03e433d20a3d28a768203337bc40b6e4b2c59"
    mukey_1 = "05ed2b4a3fb023c2ff5dd6ed4b9b6ea7383f5cfe9d59c11d121ec2c81ca2eea9"
    # routing_info_1_unencrypted = "00010101010101010100000001000000010000000000000000000000000000000028430b210c0af631ef80dc8594c08557ce4626bdd3593314624a588cc083a1d9e22ca641baa077154733abc586fae578ea0ed4c1851d0554235171e45e1e2a1868352b14951972fbeec9ffa500e74d24fd6d3b925c191c3454b97f518d68585db436277ec6404d85da476af5cfbfe7a392d4b8c931b57629c04ff70c08e51fa8d73e8ef55fd23b09430d4807dbdc4a7419c97b2e46d0568ca77526944e7c6a615475faea10de1025016f6fcb6f685ebdaf55c7908fd926f531d27e206307f7c9086355a351298fd6ed1f05d8724a6b159f52ed4cb988cde07f1d0eb0384803511b480ed31a1ecb7320bbd98da168ae64de73347d59df8ed0588aba661dc2d0bba2bc74ac0d2c479f466ee73def4a32cd806b0966b8f535e742c6a907af0f3dad003016db95194d381109c53499efcf4d868677c3a6dc4a184eccc2198aec260673a801814e60405670f557e618bb3b5df1e51cc90d995d0832b307c102b3fd1d083f52794ccb5a185885280dbd9e36ce64ddf320b6a7e340180e4f525c682bcd1f9cfa3ae5bbd8cdbd83e3d291e98606a7890bd8abbcf57aea1492fc1d6c876cad86446fc85b2db47ff2c6ea384fdda8bc53e81152687a702318c91f657253403612393ec7f864ddf5e807497cb88816f736f08a593d8d1e2c46c13675de2b2aa8c383b8610a5c772bbcf831e426f750c6358e623d9938890aa1d70297c4e4d238b14967f48da074ca469212336a77a2fe0fc80dc2ecd59a2ca389440cb2c1f9835786ad7e1f5bf3ceb27c8abe10178bffcbd888a9b31b9b9a5e308cefe00bdc25c82597dc22ff814b4dcb717be6ec6d87cf25dbb9fde6726461d504d4b9707d708238415ca3dc6e86d3738b902ff4a449597fcac06757fd97e0fe52c1addf7b34731366e2a5694883c60f4c9676ea6167a9fbf8b7d64932676e11fd38f7338e8954236ae31dbd7e2732d74a16b4d0809229ce44e696ceb383c41375ea0e40686f4e0c3967fa22a9e8a2ebb637816c8d1875edf86b1a4998b8525708a027a57852e28e7e84ab3d0db6b73b7e6775604d317139bc0146fedf45a17bc8b3559d4921cb87c51a21f374e040da55e013f4748b22e58f3a53f8ba733bf823eec2f2e8250d3584bd0719bdc36c1f411bfc3d6baf0db966ff2f60dc348da8ed5d011634677ff04c705b6a6942eaffbea4dc0ff5451083f5f7117df044b868df8ae2291ee68998f4c159e885ebcd1073f751899557546e5d8ddbee87a5747e5fa3f5610adf7dece55a339276e7efc3d9a152f222dd3f0452ee4ec56af7a5c1f3b9130ccf1c689e8e1401e8b885ca67349b69526ff523f217c3b36c643a9c46c46b0dc2d0f1d80c83435f752740ee7e423a59badfd5981706ec62d38ce07295ef4fbe23a4ab6cf85a2289e09cc5ad0bae981d3f42e9c6c85eeaff1f257e8ab99c2e93754e88ccd23fe3ad9c78be182b3944b79877aa1eced48b8fcf1f51c5cd01c4b2b111c97f0338e0efccc61e728e784c51d50371f453d926b02fae5c46e118a2f23a28d6f0830ec04b736ed84cf09ea1b0e228d13d7c8794ae6f363d100538a9baa9fbe533a909717dcce4c012d7f258aaee4b41c2e3f1bfe44a652ba8da51dc67164c43112805d474372b9076f3f3f0e7af94604f4fcddd2136dd7dc80ce3ff845924462cf52f5818aebf3b64f38f98edf8cb9c460477a2f94b891573929c4b51deafe6db81bc30680f7226a68567588f195ce96a791e28204b9b5844c28a61736ac20722fe156175210c7b9b6e1804c89c0a7ee136"
    routing_info_1_unencrypted = "00010101010101010100000000000000010000000100000000000000000000000054acbad6d1ccad9d13b3ba4f6c035615132a771159108b0b74086d9b823a39b734a1038b42cdd4bcc5468613cbccc46d7a1c2b35162581bacf66c584f2164ce8ee6975c9c518b49e2760932c1cee1488a9933faf5627cd00e962c7c8c192b62ef9f1ecd14e827b5f2e9ccad20336e51ff81e3e942fbbef0ac77d5a8a6da0414f551f89c83fabfc96a4533d72f6795d474f17f38a9835513274bd7c3eae4cc9dee7479cbfb1ad0702a0671279cf7af5c084a501783dcb25da45a63ea16cd72fd732418138957da6ba79081d8b374298b6d2ad3d87ce9097f1cc03eb42a3f9244fbce6a4d49f69b42d67cc0d5074f0c06233a947a6c8cf7249602ee9a4aa003f0aecb5e277b324f1821cebbd7c1619a01af6c3997aeabdb9a8a8607bea671e86f8a335ee019442467e93115e358ea128fba7be2dd83135d651e997a75faa3a12c496e7f7d6a490ed62e41a542dc1b0f9be7aa1cb9531b6906e085b3e2685dc3b90099aac4ec4d852ae2cd99a47652c5a010702588ac52dc462b8a3dc5c8e51c1a624cbf0fd53e95e3047edba9f58e95b25ba96eb393e92d0d1dcf930d04cc82b2a2a1a1d5bd19f133749c67c621ce19fb2dfb86758a76f1eca82bd34715201e15c05809e114b18bb12a9b31f25760a1fa5a73914ceb0f810c9c4e8f83586603775373fe31cf8ff0f8b0fc8f25a86cc4076df629666251d79ddb7cd32b44b510662188e7b2d22d6cfd37a5b2fad3b978ac357b5315ce2c4045cc4cfdb8c12735810787d06c78ae52e18c48ab7d7288a443197d8b809b7ff894bb6bf5628da3e7334d597b46077ae5cd164563ec4aca300d03ddab0d56dfb9a3caa794f704c1ab9a26b204964c5ada76840e020f5bb34e90cae9b428ca065e495d575913d6d8a0f1b8641038ea63ce1f23a5819e88310a34f6ba3186c568073c81f5a19d2ee41fc9dcc1cc92b8e4822779339d9387900bf792c98c8a58937d856a53f3adc3866f8f00ea2af403ea341c0616e4bb039c9879f18f5fc7b20328190f01f16f341cc79a235af322460b6a50edcb2d4389eaf115bcb7adafdbfacee1fd7237d21d756a050020e060478da492c289549047c6e75b0461d1d91bfd522f222ec9a8adfeb16447f452e12992f11ec11aba9e0e54769fd49e2b2363c1b2efbd3928c212d2099b07243871d16d71f9642eabe424e9a26065ea856aee9e88311a7309cf39f33347b8218c4ad86534088d01f61bde4c21741549338a2cad992ede4f111aff3e790abdc2c51974cb0e69af69cb5bc4728bb80db3d35fa7b0a0ec66b4dd635646380d469fecea673fd0e539f79d22878028fd4c4306f06ec1cfac4a12869948e2bf028280df7b0812b5ae9a56de355c1d354dd96104292374e77adb20689d392748ae6cc2529452e0f36d69bbdc793dc044de657b72fb4f9f5e527978520cdf01682098d799e8150a821bbca665c292206ca3132243d1a44a7c5cbe3574349304ed5887dd4d94a4927880d465fd25f87ce44b7e5a909ece47c1dc0e6322f7c3f1f0a67acbd266158a8dcc1fea4e6bb595b207e53a4ad2db04226a5a60d28093fc11fb50894ca279e647dcd5cee93766330031cc289a5e7a070be7d0027268e1ea519cb72dc14021999c24da981ae91a6c15fed3f2c21055b51833c5fa77e1b861d2bfe94c7c9cbd58e0cfc1e25f2194ada6dddbfb8fde4d7f2e2e3a3b31a104144dc7f1108d985684b0978b43c2c7c1c5e548de1725203c1e9e7294475491c9cb8f8c93fd068dcf28a2faeae9bee0526419e97e88b4c"
    # routing_info_1_encrypted = "03445185327b8cbf5c5bfa27f925f3a9af4f431f6f7a16ad786704887cbd85bd9396df49c699c185373e4e7ac62eaf2d709eff47aa3705a235186ca412925b98902e464b80d7772900ad5040e65174840ee298625c77768d6199fa32154615bb0bd89aa137d124cb1ffcc83b85bb15ec01132794fa24cd81f94e30cc9f3de57ab16f00b29fe5456be97ea49b4b0b4601a96b8432e111ca36ae7d94c9de13ecda4ed4b7bd20a156a0697d11943871402bb1c32a312fa4f0f6ee1a0e2eb87c1fcb64d57985a7e9c07d9fba335719c04ec18607918874c513ad4c6426bd0181a3233ba12283b03be24cb8e2a530a8cb92b9bed43889267aab86d69d3d72f734e6768324125c75b25988ac2aab93da5939e2059fc0d5479d7c404b6bd1e5a9e995e47cb6966bb063377aedd689052f0a72c6576548f7264989ccd9838068b56cf7e3620f88627276674be6376007208afb027234b9e2a0267a51141ffa8ae1f3da72a8604417e63cffc3d5c4263c7e96c7ef2baa91dcf629efb87a088550b6165686c75ff9f60f24d79b5e560ceb38e987f0371cd002c1ebd09cfe3bfa1191ea1e4b23886d20a64a4526584d7beb2db9c51c3895d84cc9ecb15bff52cc64320c1f79f7d3659e2ee54a4aeed1cebb412eacd782f83ae2288c623e1a1256370262fd1afbb1a61d5e323d5bd679690105b597f027141d035a0f6ec4ef468d9a3ab39b9d54f1817878b745567f181b6678b9900299c11f21c92618da90cb10b2ecbef3d07a0b78cd35ddcc11d02e2e859f9296687268979557b99a9eaffd0875bdce1c03b1f507537916d0aba5aa437c3611ddf9e6975fc82545b67344a4f02125b08a27873079e4490519ec839a105638728d6b2dffa8024b6c4eb08dd793fbd7e53aac0e327401e1de38f826d7ac66beea3925232b0c7d086095a474b1c4f5dbb5651f5de1d1699b90bb500202673d867d00654244ece624c820d7a84db2c5e9515ace71158e45d52790a47b3b7c33ffda69b04dcf107a61a5bb0e6ab6bf06d6b44552d823f2b5969ccbe2f3986cb7180bf7acad66684117c391ff428a2023d7d29063766bb9fbb2c276c3067fab08c7fcf18fa3741b2bd409a58a4fc67d9cffde1faeb39dd86b21fa9b7930c2c6b8d28e4aeea263b3bec2bbc95b939c6ad208689204b83ea8eec2e90a42c0fde1ca8de5aaacd8a614328f83480b4a5bb5e12546ba0e56aef9e88d813dcc7c83f905c91bc5853b7d734a160f3e0efc10237aae97767abea0181c48861f2fabe52a38bcd7859d25ac5dc80eb457615d5064d77a81516b97f90c2feab7861dd9728d51a05247ef5defa05d77486812bd909195ef11c772b374d6cbe18a218af26aa19c72de077307567fa90b18eb1bc77a357ab09cc637b93d5d55793ea075285d60b04ca48bcdd45a32f55932358687db09440ff4ba255fa72e4dacee47e9029bfc16af51e121efdeb189b31dd5be103ef9dd2b5eac641768a81fce1056e6416cb8fc53b8fe946f8e37ab1f94520c3fb0d01dc15207cdec370b0fe76e5234343db30b2f8e0afdc50f1d52d761fbcd3dfcca053f01cfd3c43763546f9d5fc66e1adba7c9d66af0f61d27622f12372c4a75af5861151dcd2da571c7e90c7bde4dae9aea645f85c0781e4472e2b68d63d6789e3dc7ccb543ec47d68d1fa700c0081908a8d2e4687b6e826f4254bc169921b7e02643f3faa0264c7ff77a52205a9388d0a98c0394dc4dee81989115ade30d309374fea8435815418038534d12e4ffe88b91406a71d89d5a083e3b8224d86b2be11be32169afb04b9ea997854be9085472c342ef5fca19bf5479"
    routing_info_1_encrypted = "03445185327b8cbf5c5bfa27f825f3a9af4f431f6e7a16ad786704887cbd85bd93ea30f8314407de9bc27d1c0cd66cfe3243931606bd4c1a2a0e2e9105d0e200fef8cbee4a2f1a8aa92f256d301c42a51b728a9da8e44e098f75cd8675ea1dddfb5ec6ffea81250d7a3561570ca71cb5ad47d990c72ef350cdf3eb7406711f94c222c779306d875d338a7f3b6cc7cf0315014eb4bc0fc4af8d7aa6645876a984a95696ba1dc12f67f69a4fe14d5ce53c8295f4b98b7a15f150c9c674129c2f68db664be3f248b36ab81b3b2aab605c6afb2c614e9c7701ae631052fd808e73fb259b00572bffb665d476b228fb8e9a4a1d99c759ed0db3dcc72e239705af57519d83bcf672372ef7f26ddc47078ca18c03721aa69c0c6cbcd25375b66b5e570bcdf89ffd6bdd3fccf08c0c5f6ef321548013e0673a1bc140966926ba58a4e65837ac8d9aa8773c40a0b5789c219db5e5c41581b8bbb193cd5db8a1efa7d30c466a850be1b1d60f6ee150c93fb54fcc2dc821d50baa15c0751c326d69519139404a5e5c0838acc493e82250597231359cf87f0fa96b985abbdc9b57829f3827a148b33a2a61fc17a0a5b715b26070c5c11b88c7ac28799f7e546421c61e5dbbd5b154f9c71afc8e746de7fa01c90a0295989bd16d6179655aa0b3f3ca6c558ea8e78234ba71bedd841925321969bf2567944412e71ee6ab5938ae23a3394025810b6e7d18dc2eb005833c6f6c13db7ab5bfd84839cd3e9c9bc4767c575a626632ca2b47ff7f0b977e779e3338209a6b9513c12d6c0699b24f6915642775d0dd9a580e2dd313e22ade4ea07bb76b8747aa5cff4ca8a45bfae1948811478185545f6fc02675beae954fd3b50ba38da5c8879045bd9745b848ccc3198b61a37d9965d129d670c447368320119f35c0c122388bccce404e0097171cf3519ab41942cf3d53e37973d422d8b8bbf92b2268662c6c48e605b02976ed523586cdc687ec016250c6af944ac53b728f773d8db5dddfb471a17c80ca1a188f90442f7f662dea40421e16efc592819a11a0171e05bf47bf66e8509488b9374ac26d622c337bbfac0cf447e8266b5b0515aee781052bfeb58e10c895b74f9a8f54ff9a16ba1c93aabe1deae09860c3680a132b8312376f66ae8c46dc3e4f81dbcdbdb0a159bbe01464e0f554cd224a912f267c2c1b11f84e40fb39df407c456dbcaac5e9369b81d2bbc59fdce7b1b98383f94435f183acc866cb9f4d11c7f01df3ab8e8282a767dbc4894011c11587a6def84972c41603f1af9a9ef1f3551d3711e1b88ad1439a36fa5d9298a105693563fe27c5b43da6ffe9a26cdfdd2cd9110c798229ccb7fea801409bc9eddd6c197012296e3d6caebc676c341a37448d67e18155e079e00541e488ae4afcd45ae6b8e32d5b5f0123d619baa0cde91922a6897d583329708c1dc0679cb3e2c13f48c5ecda9215f8534b60c06e590edf4412d7f6447a802993506d1d5370a3535b8218c68b43de4fc629160d58d15b7a06eb02429389a6fba97583a0d595c79a70ff659e570845956c719b4008e2a337ff5346becb5b9c22e38b4d2ef10005bc69c13c33b1ec2e8132a09fbeb38536db65d9eeb2755083667b6348d6a4c7e3626f643266aee0641f2d2f9d0f34f4a91997ce5311c1180e774c6b761bb1186aed356e20fff5b0b24e8b17dd0c2c9c3a662cc0958f54bb8a63d2fc9e94cb9edfb6f8d0ad91a81ad1a3495bcd7f610260a64a678653fc72a2565ac5b653606a1531e2f57a11385b2ea0954c521015266bed74d937d09075dca23dbb736c3f5e16b4e7aa8172435fcdd6c884293e03"
    # hmac_data_1 = "03445185327b8cbf5c5bfa27f925f3a9af4f431f6f7a16ad786704887cbd85bd9396df49c699c185373e4e7ac62eaf2d709eff47aa3705a235186ca412925b98902e464b80d7772900ad5040e65174840ee298625c77768d6199fa32154615bb0bd89aa137d124cb1ffcc83b85bb15ec01132794fa24cd81f94e30cc9f3de57ab16f00b29fe5456be97ea49b4b0b4601a96b8432e111ca36ae7d94c9de13ecda4ed4b7bd20a156a0697d11943871402bb1c32a312fa4f0f6ee1a0e2eb87c1fcb64d57985a7e9c07d9fba335719c04ec18607918874c513ad4c6426bd0181a3233ba12283b03be24cb8e2a530a8cb92b9bed43889267aab86d69d3d72f734e6768324125c75b25988ac2aab93da5939e2059fc0d5479d7c404b6bd1e5a9e995e47cb6966bb063377aedd689052f0a72c6576548f7264989ccd9838068b56cf7e3620f88627276674be6376007208afb027234b9e2a0267a51141ffa8ae1f3da72a8604417e63cffc3d5c4263c7e96c7ef2baa91dcf629efb87a088550b6165686c75ff9f60f24d79b5e560ceb38e987f0371cd002c1ebd09cfe3bfa1191ea1e4b23886d20a64a4526584d7beb2db9c51c3895d84cc9ecb15bff52cc64320c1f79f7d3659e2ee54a4aeed1cebb412eacd782f83ae2288c623e1a1256370262fd1afbb1a61d5e323d5bd679690105b597f027141d035a0f6ec4ef468d9a3ab39b9d54f1817878b745567f181b6678b9900299c11f21c92618da90cb10b2ecbef3d07a0b78cd35ddcc11d02e2e859f9296687268979557b99a9eaffd0875bdce1c03b1f507537916d0aba5aa437c3611ddf9e6975fc82545b67344a4f02125b08a27873079e4490519ec839a105638728d6b2dffa8024b6c4eb08dd793fbd7e53aac0e327401e1de38f826d7ac66beea3925232b0c7d086095a474b1c4f5dbb5651f5de1d1699b90bb500202673d867d00654244ece624c820d7a84db2c5e9515ace71158e45d52790a47b3b7c33ffda69b04dcf107a61a5bb0e6ab6bf06d6b44552d823f2b5969ccbe2f3986cb7180bf7acad66684117c391ff428a2023d7d29063766bb9fbb2c276c3067fab08c7fcf18fa3741b2bd409a58a4fc67d9cffde1faeb39dd86b21fa9b7930c2c6b8d28e4aeea263b3bec2bbc95b939c6ad208689204b83ea8eec2e90a42c0fde1ca8de5aaacd8a614328f83480b4a5bb5e12546ba0e56aef9e88d813dcc7c83f905c91bc5853b7d734a160f3e0efc10237aae97767abea0181c48861f2fabe52a38bcd7859d25ac5dc80eb457615d5064d77a81516b97f90c2feab7861dd9728d51a05247ef5defa05d77486812bd909195ef11c772b374d6cbe18a218af26aa19c72de077307567fa90b18eb1bc77a357ab09cc637b93d5d55793ea075285d60b04ca48bcdd45a32f55932358687db09440ff4ba255fa72e4dacee47e9029bfc16af51e121efdeb189b31dd5be103ef9dd2b5eac641768a81fce1056e6416cb8fc53b8fe946f8e37ab1f94520c3fb0d01dc15207cdec370b0fe76e5234343db30b2f8e0afdc50f1d52d761fbcd3dfcca053f01cfd3c43763546f9d5fc66e1adba7c9d66af0f61d27622f12372c4a75af5861151dcd2da571c7e90c7bde4dae9aea645f85c0781e4472e2b68d63d6789e3dc7ccb543ec47d68d1fa700c0081908a8d2e4687b6e826f4254bc169921b7e02643f3faa0264c7ff77a52205a9388d0a98c0394dc4dee81989115ade30d309374fea8435815418038534d12e4ffe88b91406a71d89d5a083e3b8224d86b2be11be32169afb04b9ea997854be9085472c342ef5fca19bf54794242424242424242424242424242424242424242424242424242424242424242"
    # hmac_1 = "0daed5f832ef34ea8d0d2cc0699134287a2739c77152d9edc8fe5ccce7ec838f"

    rhokey_0 = "ce496ec94def95aadd4bec15cdb41a740c9f2b62347c4917325fcc6fb0453986"
    mukey_0 = "b57061dc6d0a2b9f261ac410c8b26d64ac5506cbba30267a649c28c179400eba"
    # routing_info_0_unencrypted = "0000000000000000000000000000000000000000000000000000000000000000002bdc5227c8eb8ba5fcfc15cfc2aa578ff208c106646d0652cd289c0a37e445bb03445185327b8cbf5c5bfa27f925f3a9af4f431f6f7a16ad786704887cbd85bd9396df49c699c185373e4e7ac62eaf2d709eff47aa3705a235186ca412925b98902e464b80d7772900ad5040e65174840ee298625c77768d6199fa32154615bb0bd89aa137d124cb1ffcc83b85bb15ec01132794fa24cd81f94e30cc9f3de57ab16f00b29fe5456be97ea49b4b0b4601a96b8432e111ca36ae7d94c9de13ecda4ed4b7bd20a156a0697d11943871402bb1c32a312fa4f0f6ee1a0e2eb87c1fcb64d57985a7e9c07d9fba335719c04ec18607918874c513ad4c6426bd0181a3233ba12283b03be24cb8e2a530a8cb92b9bed43889267aab86d69d3d72f734e6768324125c75b25988ac2aab93da5939e2059fc0d5479d7c404b6bd1e5a9e995e47cb6966bb063377aedd689052f0a72c6576548f7264989ccd9838068b56cf7e3620f88627276674be6376007208afb027234b9e2a0267a51141ffa8ae1f3da72a8604417e63cffc3d5c4263c7e96c7ef2baa91dcf629efb87a088550b6165686c75ff9f60f24d79b5e560ceb38e987f0371cd002c1ebd09cfe3bfa1191ea1e4b23886d20a64a4526584d7beb2db9c51c3895d84cc9ecb15bff52cc64320c1f79f7d3659e2ee54a4aeed1cebb412eacd782f83ae2288c623e1a1256370262fd1afbb1a61d5e323d5bd679690105b597f027141d035a0f6ec4ef468d9a3ab39b9d54f1817878b745567f181b6678b9900299c11f21c92618da90cb10b2ecbef3d07a0b78cd35ddcc11d02e2e859f9296687268979557b99a9eaffd0875bdce1c03b1f507537916d0aba5aa437c3611ddf9e6975fc82545b67344a4f02125b08a27873079e4490519ec839a105638728d6b2dffa8024b6c4eb08dd793fbd7e53aac0e327401e1de38f826d7ac66beea3925232b0c7d086095a474b1c4f5dbb5651f5de1d1699b90bb500202673d867d00654244ece624c820d7a84db2c5e9515ace71158e45d52790a47b3b7c33ffda69b04dcf107a61a5bb0e6ab6bf06d6b44552d823f2b5969ccbe2f3986cb7180bf7acad66684117c391ff428a2023d7d29063766bb9fbb2c276c3067fab08c7fcf18fa3741b2bd409a58a4fc67d9cffde1faeb39dd86b21fa9b7930c2c6b8d28e4aeea263b3bec2bbc95b939c6ad208689204b83ea8eec2e90a42c0fde1ca8de5aaacd8a614328f83480b4a5bb5e12546ba0e56aef9e88d813dcc7c83f905c91bc5853b7d734a160f3e0efc10237aae97767abea0181c48861f2fabe52a38bcd7859d25ac5dc80eb457615d5064d77a81516b97f90c2feab7861dd9728d51a05247ef5defa05d77486812bd909195ef11c772b374d6cbe18a218af26aa19c72de077307567fa90b18eb1bc77a357ab09cc637b93d5d55793ea075285d60b04ca48bcdd45a32f55932358687db09440ff4ba255fa72e4dacee47e9029bfc16af51e121efdeb189b31dd5be103ef9dd2b5eac641768a81fce1056e6416cb8fc53b8fe946f8e37ab1f94520c3fb0d01dc15207cdec370b0fe76e5234343db30b2f8e0afdc50f1d52d761fbcd3dfcca053f01cfd3c43763546f9d5fc66e1adba7c9d66af0f61d27622f12372c4a75af5861151dcd2da571c7e90c7bde4dae9aea645f85c0781e4472e2b68d63d6789e3dc7ccb543ec47d68d1fa700c0081908a8d2e4687b6e826f4254bc169921b7e02643f3faa0264c7ff77a52205a9388d0a98c0394dc4dee81"
    routing_info_0_unencrypted = "000000000000000000000000000000000000000000000000000000000000000000f21f8f30d10efb1b402153aaca4fc78823bb045c37d8959c065360020bc5e9d4f8cbee4a2f1a8aa92f256d301c42a51b728a9da8e44e098f75cd8675ea1dddfb5ec6ffea81250d7a3561570ca71cb5ad47d990c72ef350cdf3eb7406711f94c222c779306d875d338a7f3b6cc7cf0315014eb4bc0fc4af8d7aa6645876a984a95696ba1dc12f67f69a4fe14d5ce53c8295f4b98b7a15f150c9c674129c2f68db664be3f248b36ab81b3b2aab605c6afb2c614e9c7701ae631052fd808e73fb259b00572bffb665d476b228fb8e9a4a1d99c759ed0db3dcc72e239705af57519d83bcf672372ef7f26ddc47078ca18c03721aa69c0c6cbcd25375b66b5e570bcdf89ffd6bdd3fccf08c0c5f6ef321548013e0673a1bc140966926ba58a4e65837ac8d9aa8773c40a0b5789c219db5e5c41581b8bbb193cd5db8a1efa7d30c466a850be1b1d60f6ee150c93fb54fcc2dc821d50baa15c0751c326d69519139404a5e5c0838acc493e82250597231359cf87f0fa96b985abbdc9b57829f3827a148b33a2a61fc17a0a5b715b26070c5c11b88c7ac28799f7e546421c61e5dbbd5b154f9c71afc8e746de7fa01c90a0295989bd16d6179655aa0b3f3ca6c558ea8e78234ba71bedd841925321969bf2567944412e71ee6ab5938ae23a3394025810b6e7d18dc2eb005833c6f6c13db7ab5bfd84839cd3e9c9bc4767c575a626632ca2b47ff7f0b977e779e3338209a6b9513c12d6c0699b24f6915642775d0dd9a580e2dd313e22ade4ea07bb76b8747aa5cff4ca8a45bfae1948811478185545f6fc02675beae954fd3b50ba38da5c8879045bd9745b848ccc3198b61a37d9965d129d670c447368320119f35c0c122388bccce404e0097171cf3519ab41942cf3d53e37973d422d8b8bbf92b2268662c6c48e605b02976ed523586cdc687ec016250c6af944ac53b728f773d8db5dddfb471a17c80ca1a188f90442f7f662dea40421e16efc592819a11a0171e05bf47bf66e8509488b9374ac26d622c337bbfac0cf447e8266b5b0515aee781052bfeb58e10c895b74f9a8f54ff9a16ba1c93aabe1deae09860c3680a132b8312376f66ae8c46dc3e4f81dbcdbdb0a159bbe01464e0f554cd224a912f267c2c1b11f84e40fb39df407c456dbcaac5e9369b81d2bbc59fdce7b1b98383f94435f183acc866cb9f4d11c7f01df3ab8e8282a767dbc4894011c11587a6def84972c41603f1af9a9ef1f3551d3711e1b88ad1439a36fa5d9298a105693563fe27c5b43da6ffe9a26cdfdd2cd9110c798229ccb7fea801409bc9eddd6c197012296e3d6caebc676c341a37448d67e18155e079e00541e488ae4afcd45ae6b8e32d5b5f0123d619baa0cde91922a6897d583329708c1dc0679cb3e2c13f48c5ecda9215f8534b60c06e590edf4412d7f6447a802993506d1d5370a3535b8218c68b43de4fc629160d58d15b7a06eb02429389a6fba97583a0d595c79a70ff659e570845956c719b4008e2a337ff5346becb5b9c22e38b4d2ef10005bc69c13c33b1ec2e8132a09fbeb38536db65d9eeb2755083667b6348d6a4c7e3626f643266aee0641f2d2f9d0f34f4a91997ce5311c1180e774c6b761bb1186aed356e20fff5b0b24e8b17dd0c2c9c3a662cc0958f54bb8a63d2fc9e94cb9edfb6f8d0ad91a81ad1a3495bcd7f610260a64a678653fc72a2565ac5b653606a1531e2f57a11385b2ea0954c521015266bed74d937d09075dca23dbb736c3f5e16b4e7aa8172435fcdd6c884293e03"
    # routing_info_0_encrypted = "e5f14350c2a76fc232b5e46d421e9615471ab9e0bc887beff8c95fdb878f7b3a716a996c7845c93d90e4ecbb9bde4ece2f69425c99e4bc820e44485455f135edc0d10f7d61ab590531cf08000179a333a347f8b4072f216400406bdf3bf038659793d4a1fd7b246979e3150a0a4cb052c9ec69acf0f48c3d39cd55675fe717cb7d80ce721caad69320c3a469a202f1e468c67eaf7a7cd8226d0fd32f7b48084dca885d56047694762b67021713ca673929c163ec36e04e40ca8e1c6d17569419d3039d9a1ec866abe044a9ad635778b961fc0776dc832b3a451bd5d35072d2269cf9b040f6b7a7dad84fb114ed413b1426cb96ceaf83825665ed5a1d002c1687f92465b49ed4c7f0218ff8c6c7dd7221d589c65b3b9aaa71a41484b122846c7c7b57e02e679ea8469b70e14fe4f70fee4d87b910cf144be6fe48eef24da475c0b0bcc6565ae82cd3f4e3b24c76eaa5616c6111343306ab35c1fe5ca4a77c0e314ed7dba39d6f1e0de791719c241a939cc493bea2bae1c1e932679ea94d29084278513c77b899cc98059d06a27d171b0dbdf6bee13ddc4fc17a0c4d2827d488436b57baa167544138ca2e64a11b43ac8a06cd0c2fba2d4d900ed2d9205305e2d7383cc98dacb078133de5f6fb6bed2ef26ba92cea28aafc3b9948dd9ae5559e8bd6920b8cea462aa445ca6a95e0e7ba52961b181c79e73bd581821df2b10173727a810c92b83b5ba4a0403eb710d2ca10689a35bec6c3a708e9e92f7d78ff3c5d9989574b00c6736f84c199256e76e19e78f0c98a9d580b4a658c84fc8f2096c2fbea8f5f8c59d0fdacb3be2802ef802abbecb3aba4acaac69a0e965abd8981e9896b1f6ef9d60f7a164b371af869fd0e48073742825e9434fc54da837e120266d53302954843538ea7c6c3dbfb4ff3b2fdbe244437f2a153ccf7bdb4c92aa08102d4f3cff2ae5ef86fab4653595e6a5837fa2f3e29f27a9cde5966843fb847a4a61f1e76c281fe8bb2b0a181d096100db5a1a5ce7a910238251a43ca556712eaadea167fb4d7d75825e440f3ecd782036d7574df8bceacb397abefc5f5254d2722215c53ff54af8299aaaad642c6d72a14d27882d9bbd539e1cc7a527526ba89b8c037ad09120e98ab042d3e8652b31ae0e478516bfaf88efca9f3676ffe99d2819dcaeb7610a626695f53117665d267d3f7abebd6bbd6733f645c72c389f03855bdf1e4b8075b516569b118233a0f0971d24b83113c0b096f5216a207ca99a7cddc81c130923fe3d91e7508c9ac5f2e914ff5dccab9e558566fa14efb34ac98d878580814b94b73acbfde9072f30b881f7f0fff42d4045d1ace6322d86a97d164aa84d93a60498065cc7c20e636f5862dc81531a88c60305a2e59a985be327a6902e4bed986dbf4a0b50c217af0ea7fdf9ab37f9ea1a1aaa72f54cf40154ea9b269f1a7c09f9f43245109431a175d50e2db0132337baa0ef97eed0fcf20489da36b79a1172faccc2f7ded7c60e00694282d93359c4682135642bc81f433574aa8ef0c97b4ade7ca372c5ffc23c7eddd839bab4e0f14d6df15c9dbeab176bec8b5701cf054eb3072f6dadc98f88819042bf10c407516ee58bce33fbe3b3d86a54255e577db4598e30a135361528c101683a5fcde7e8ba53f3456254be8f45fe3a56120ae96ea3773631fcb3873aa3abd91bcff00bd38bd43697a2e789e00da6077482e7b1b1a677b5afae4c54e6cbdf7377b694eb7d7a5b913476a5be923322d3de06060fd5e819635232a2cf4f0731da13b8546d1d6d4f8d75b9fce6c2341a71b0ea6f780df54bfdb0dd5cd9855179f602f9172"
    routing_info_0_encrypted = "e5f14350c2a76fc232b5e46d421e9615471ab9e0bc887beff8c95fdb878f7b3a71b35ab16f5c2c4d2e5831fdfed6ab5e28b8f199c3b70911c08f33a85dcd1441af2a80c2aeb6380327bc7697169cc465119a3d6ab0a4157b224dc15dc666983dd15e84815e3c98a586e14a137c2d824849db2ec370704868560ba67ffd849a042732274d674786b93a4976028e236f93f9c9d283a42f6bfb6d14ecb1112be7dcd8d51376b8806a3516e2b13e651339104755847229607f7c1bbe9429c955869472d4b9795e1f308433b6ec23537c2f959b790dbc72153b5e10a5faba1922b231632c64a06068b0e9ac507e2d82f7d01e10e392bd73a1957a542d63842b3b3dc9afc30c3b694400c7ae7d9eb2974813e3177ddb6c2fe203dedb0b9521f4dbbad49594def18ff3ac6827440fb5baace528742a8d4f7c29f00deef7557567f7a77ef1936fdeaeeaa2cadcfae07bc4ad49bd4a710f4c5df0a584dc0d969ae506ebe2c02e66d4470972547c2c6e2a947a55c3cae50ee1e7d24815e28c7040740d5df5d16d6ff7e2477e6ca659619b0806a46a47fb85f1b4e43300f7830550320d5c38514ce0cf114e6a67ac4cb535474dff8cf26e61124ea2fb01e2ccf0631dee4f540faf6fb34043d2b0cb5c5af649dfc5e00305e1574b1272b1a50515aa9891fa3d7a33b75bbb5ebd657ab715f7627526f01e679f232bc87c3de2d36c9dec735aec0818a2effa3b0eeb69928015b8489e0900c085bde9d5b7f11385417c159f38924959a1126293d62ca889d3744fe93f9c9b16f0fb989bb66bc876a65660caf8c33eb0530de7c34d66b46cdd840f107e10e58a3e1c213e763fd4164c0d8ee06b4536d132638a4d47f9d42e1297f053a71fb030e24252b16562a1e2aceaa8d2551f07ab21e2df7d73dd2c72f6ad47b8c0578f947d5bb1d773f2a34048de5c1652c4180020cf653379393b9325682d0e7ef9309f36939b90603f3ce137da02e84e9f6841eaad572ae588381901103b9d27eb24f32fbe875378b50efeb621dfda8a65f2f5e9b83289d562eff7e283cf544044b751d863f962dda40ac1cf151cff67c2405cbd9a52a7e34938c43f4df03c26bd1111a75a366d3f1860f23377654a125f40a609b55c1cf29021fda679b2588f822ae7927ff6d3749ed826c4f7ed70f0a2f68f41a7d96f461a3b760ac652b93f6e121424c9222fa393d89730cab640b5a629b5a9a30fc110739fda8a9aae1902ef5716e3afe2ef7730293221465740565212a03629cf91c36e3d0070a071e5ac87cc38c95609c5330d6a341b4390c0a9b8e0d4ab636495cf2755a0a34eb28e2deb65add0e0d71f27ba053e0a838b08b759b615645aefc512f353178b23b0b74ead0c8ad5587ab590ea5c928898b2bd532e4371951cbc90b8285bd49d81700fb91be6dee67f0e3ff0e0131bb906e6d32fe2dd1ae2edb89cd45de6668f3814707b04dabc9723c37e6da1f06e617ecf10fdc8c4bf59af32f5c137d84d76979372edd9ccefc45fb844ca203bc7251b399a5859f8330b6c6cc693fd214b5a573d2d2950d3ef35f76404fcf5f89f5bd837c1c2875a2a5aa94b209c4dd1a78391e8f520c81f013cc45b3fa16f69323d1b767fb2d9ecf104d8134194de5a15087cb9c7813151fdfcf7d8f5dd533738c840f5c529601dd30c7cdaef4719cb512e1664d1a25c7697ee0b432dc95885a5d4837debacaf46fb1fc1422cddf8541adbf7bed9413bacce086bc755b57e17174139a646a8c2bbba74d61a5417740051221c070c37e09607173cb5e9859a974df8be3fbc1060005b86b729b3b2782b1f2f5e6e14c2c3384b41f0"
    # hmac_data_0 = "e5f14350c2a76fc232b5e46d421e9615471ab9e0bc887beff8c95fdb878f7b3a716a996c7845c93d90e4ecbb9bde4ece2f69425c99e4bc820e44485455f135edc0d10f7d61ab590531cf08000179a333a347f8b4072f216400406bdf3bf038659793d4a1fd7b246979e3150a0a4cb052c9ec69acf0f48c3d39cd55675fe717cb7d80ce721caad69320c3a469a202f1e468c67eaf7a7cd8226d0fd32f7b48084dca885d56047694762b67021713ca673929c163ec36e04e40ca8e1c6d17569419d3039d9a1ec866abe044a9ad635778b961fc0776dc832b3a451bd5d35072d2269cf9b040f6b7a7dad84fb114ed413b1426cb96ceaf83825665ed5a1d002c1687f92465b49ed4c7f0218ff8c6c7dd7221d589c65b3b9aaa71a41484b122846c7c7b57e02e679ea8469b70e14fe4f70fee4d87b910cf144be6fe48eef24da475c0b0bcc6565ae82cd3f4e3b24c76eaa5616c6111343306ab35c1fe5ca4a77c0e314ed7dba39d6f1e0de791719c241a939cc493bea2bae1c1e932679ea94d29084278513c77b899cc98059d06a27d171b0dbdf6bee13ddc4fc17a0c4d2827d488436b57baa167544138ca2e64a11b43ac8a06cd0c2fba2d4d900ed2d9205305e2d7383cc98dacb078133de5f6fb6bed2ef26ba92cea28aafc3b9948dd9ae5559e8bd6920b8cea462aa445ca6a95e0e7ba52961b181c79e73bd581821df2b10173727a810c92b83b5ba4a0403eb710d2ca10689a35bec6c3a708e9e92f7d78ff3c5d9989574b00c6736f84c199256e76e19e78f0c98a9d580b4a658c84fc8f2096c2fbea8f5f8c59d0fdacb3be2802ef802abbecb3aba4acaac69a0e965abd8981e9896b1f6ef9d60f7a164b371af869fd0e48073742825e9434fc54da837e120266d53302954843538ea7c6c3dbfb4ff3b2fdbe244437f2a153ccf7bdb4c92aa08102d4f3cff2ae5ef86fab4653595e6a5837fa2f3e29f27a9cde5966843fb847a4a61f1e76c281fe8bb2b0a181d096100db5a1a5ce7a910238251a43ca556712eaadea167fb4d7d75825e440f3ecd782036d7574df8bceacb397abefc5f5254d2722215c53ff54af8299aaaad642c6d72a14d27882d9bbd539e1cc7a527526ba89b8c037ad09120e98ab042d3e8652b31ae0e478516bfaf88efca9f3676ffe99d2819dcaeb7610a626695f53117665d267d3f7abebd6bbd6733f645c72c389f03855bdf1e4b8075b516569b118233a0f0971d24b83113c0b096f5216a207ca99a7cddc81c130923fe3d91e7508c9ac5f2e914ff5dccab9e558566fa14efb34ac98d878580814b94b73acbfde9072f30b881f7f0fff42d4045d1ace6322d86a97d164aa84d93a60498065cc7c20e636f5862dc81531a88c60305a2e59a985be327a6902e4bed986dbf4a0b50c217af0ea7fdf9ab37f9ea1a1aaa72f54cf40154ea9b269f1a7c09f9f43245109431a175d50e2db0132337baa0ef97eed0fcf20489da36b79a1172faccc2f7ded7c60e00694282d93359c4682135642bc81f433574aa8ef0c97b4ade7ca372c5ffc23c7eddd839bab4e0f14d6df15c9dbeab176bec8b5701cf054eb3072f6dadc98f88819042bf10c407516ee58bce33fbe3b3d86a54255e577db4598e30a135361528c101683a5fcde7e8ba53f3456254be8f45fe3a56120ae96ea3773631fcb3873aa3abd91bcff00bd38bd43697a2e789e00da6077482e7b1b1a677b5afae4c54e6cbdf7377b694eb7d7a5b913476a5be923322d3de06060fd5e819635232a2cf4f0731da13b8546d1d6d4f8d75b9fce6c2341a71b0ea6f780df54bfdb0dd5cd9855179f602f91724242424242424242424242424242424242424242424242424242424242424242"
    # hmac_0 = "62cc962876e734e089e79eda497077fb411fac5f36afd43329040ecd1e16c6d9"

    # onion_packet = "0002eec7245d6b7d2ccb30380bfbe2a3648cd7a942653f5aa340edcea1f283686619e5f14350c2a76fc232b5e46d421e9615471ab9e0bc887beff8c95fdb878f7b3a71da571226458c510bbadd1276f045c21c520a07d35da256ef75b4367962437b0dd10f7d61ab590531cf08000178a333a347f8b4072e216400406bdf3bf038659793a86cae5f52d32f3438527b47a1cfc54285a8afec3a4c9f3323db0c946f5d4cb2ce721caad69320c3a469a202f3e468c67eaf7a7cda226d0fd32f7b48084dca885d15222e60826d5d971f64172d98e0760154400958f00e86697aa1aa9d41bee8119a1ec866abe044a9ad635778ba61fc0776dc832b39451bd5d35072d2269cf9b040d6ba38b54ec35f81d7fc67678c3be47274f3c4cc472aff005c3469eb3bc140769ed4c7f0218ff8c6c7dd7221d189c65b3b9aaa71a01484b122846c7c7b57e02e679ea8469b70e14fe4f70fee4d87b910cf144be6fe48eef24da475c0b0bcc6565ae82cd3f4e3b24c76eaa5616c6111343306ab35c1fe5ca4a77c0e314ed7dba39d6f1e0de791719c241a939cc493bea2bae1c1e932679ea94d29084278513c77b899cc98059d06a27d171b0dbdf6bee13ddc4fc17a0c4d2827d488436b57baa167544138ca2e64a11b43ac8a06cd0c2fba2d4d900ed2d9205305e2d7383cc98dacb078133de5f6fb6bed2ef26ba92cea28aafc3b9948dd9ae5559e8bd6920b8cea462aa445ca6a95e0e7ba52961b181c79e73bd581821df2b10173727a810c92b83b5ba4a0403eb710d2ca10689a35bec6c3a708e9e92f7d78ff3c5d9989574b00c6736f84c199256e76e19e78f0c98a9d580b4a658c84fc8f2096c2fbea8f5f8c59d0fdacb3be2802ef802abbecb3aba4acaac69a0e965abd8981e9896b1f6ef9d60f7a164b371af869fd0e48073742825e9434fc54da837e120266d53302954843538ea7c6c3dbfb4ff3b2fdbe244437f2a153ccf7bdb4c92aa08102d4f3cff2ae5ef86fab4653595e6a5837fa2f3e29f27a9cde5966843fb847a4a61f1e76c281fe8bb2b0a181d096100db5a1a5ce7a910238251a43ca556712eaadea167fb4d7d75825e440f3ecd782036d7574df8bceacb397abefc5f5254d2722215c53ff54af8299aaaad642c6d72a14d27882d9bbd539e1cc7a527526ba89b8c037ad09120e98ab042d3e8652b31ae0e478516bfaf88efca9f3676ffe99d2819dcaeb7610a626695f53117665d267d3f7abebd6bbd6733f645c72c389f03855bdf1e4b8075b516569b118233a0f0971d24b83113c0b096f5216a207ca99a7cddc81c130923fe3d91e7508c9ac5f2e914ff5dccab9e558566fa14efb34ac98d878580814b94b73acbfde9072f30b881f7f0fff42d4045d1ace6322d86a97d164aa84d93a60498065cc7c20e636f5862dc81531a88c60305a2e59a985be327a6902e4bed986dbf4a0b50c217af0ea7fdf9ab37f9ea1a1aaa72f54cf40154ea9b269f1a7c09f9f43245109431a175d50e2db0132337baa0ef97eed0fcf20489da36b79a1172faccc2f7ded7c60e00694282d93359c4682135642bc81f433574aa8ef0c97b4ade7ca372c5ffc23c7eddd839bab4e0f14d6df15c9dbeab176bec8b5701cf054eb3072f6dadc98f88819042bf10c407516ee58bce33fbe3b3d86a54255e577db4598e30a135361528c101683a5fcde7e8ba53f3456254be8f45fe3a56120ae96ea3773631fcb3873aa3abd91bcff00bd38bd43697a2e789e00da6077482e7b1b1a677b5afae4c54e6cbdf7377b694eb7d7a5b913476a5be923322d3de06060fd5e819635232a2cf4f0731da13b8546d1d6d4f8d75b9fce6c2341a71b0ea6f780df54bfdb0dd5cd9855179f602f917265f21f9190c70217774a6fbaaa7d63ad64199f4664813b955cff954949076dcf"
    onion_packet = "0002eec7245d6b7d2ccb30380bfbe2a3648cd7a942653f5aa340edcea1f283686619e5f14350c2a76fc232b5e46d421e9615471ab9e0bc887beff8c95fdb878f7b3a71b35ab16f5c2c4d2e5831fdfed6ab5e28b8f199c3b70911c08f33a85dcd1441af2a80c2aeb6380327bc7697169cc465119a3d6ab0a4157b224dc15dc666983dd15e84815e3c98a586e14a137c2d824849db2ec370704868560ba67ffd849a042732274d674786b93a4976028e236f93f9c9d283a42f6bfb6d14ecb1112be7dcd8d51376b8806a3516e2b13e651339104755847229607f7c1bbe9429c955869472d4b9795e1f308433b6ec23537c2f959b790dbc72153b5e10a5faba1922b231632c64a06068b0e9ac507e2d82f7d01e10e392bd73a1957a542d63842b3b3dc9afc30c3b694400c7ae7d9eb2974813e3177ddb6c2fe203dedb0b9521f4dbbad49594def18ff3ac6827440fb5baace528742a8d4f7c29f00deef7557567f7a77ef1936fdeaeeaa2cadcfae07bc4ad49bd4a710f4c5df0a584dc0d969ae506ebe2c02e66d4470972547c2c6e2a947a55c3cae50ee1e7d24815e28c7040740d5df5d16d6ff7e2477e6ca659619b0806a46a47fb85f1b4e43300f7830550320d5c38514ce0cf114e6a67ac4cb535474dff8cf26e61124ea2fb01e2ccf0631dee4f540faf6fb34043d2b0cb5c5af649dfc5e00305e1574b1272b1a50515aa9891fa3d7a33b75bbb5ebd657ab715f7627526f01e679f232bc87c3de2d36c9dec735aec0818a2effa3b0eeb69928015b8489e0900c085bde9d5b7f11385417c159f38924959a1126293d62ca889d3744fe93f9c9b16f0fb989bb66bc876a65660caf8c33eb0530de7c34d66b46cdd840f107e10e58a3e1c213e763fd4164c0d8ee06b4536d132638a4d47f9d42e1297f053a71fb030e24252b16562a1e2aceaa8d2551f07ab21e2df7d73dd2c72f6ad47b8c0578f947d5bb1d773f2a34048de5c1652c4180020cf653379393b9325682d0e7ef9309f36939b90603f3ce137da02e84e9f6841eaad572ae588381901103b9d27eb24f32fbe875378b50efeb621dfda8a65f2f5e9b83289d562eff7e283cf544044b751d863f962dda40ac1cf151cff67c2405cbd9a52a7e34938c43f4df03c26bd1111a75a366d3f1860f23377654a125f40a609b55c1cf29021fda679b2588f822ae7927ff6d3749ed826c4f7ed70f0a2f68f41a7d96f461a3b760ac652b93f6e121424c9222fa393d89730cab640b5a629b5a9a30fc110739fda8a9aae1902ef5716e3afe2ef7730293221465740565212a03629cf91c36e3d0070a071e5ac87cc38c95609c5330d6a341b4390c0a9b8e0d4ab636495cf2755a0a34eb28e2deb65add0e0d71f27ba053e0a838b08b759b615645aefc512f353178b23b0b74ead0c8ad5587ab590ea5c928898b2bd532e4371951cbc90b8285bd49d81700fb91be6dee67f0e3ff0e0131bb906e6d32fe2dd1ae2edb89cd45de6668f3814707b04dabc9723c37e6da1f06e617ecf10fdc8c4bf59af32f5c137d84d76979372edd9ccefc45fb844ca203bc7251b399a5859f8330b6c6cc693fd214b5a573d2d2950d3ef35f76404fcf5f89f5bd837c1c2875a2a5aa94b209c4dd1a78391e8f520c81f013cc45b3fa16f69323d1b767fb2d9ecf104d8134194de5a15087cb9c7813151fdfcf7d8f5dd533738c840f5c529601dd30c7cdaef4719cb512e1664d1a25c7697ee0b432dc95885a5d4837debacaf46fb1fc1422cddf8541adbf7bed9413bacce086bc755b57e17174139a646a8c2bbba74d61a5417740051221c070c37e09607173cb5e9859a974df8be3fbc1060005b86b729b3b2782b1f2f5e6e14c2c3384b41f0f21f8f30d10efb1b402153aaca4fc78823bb045c37d8959c065360020bc5e9d4"

    hops = [
      {pubkey_0, hop_payload_0},
      {pubkey_1, hop_payload_1},
      {pubkey_2, hop_payload_2},
      {pubkey_3, hop_payload_3},
      {pubkey_4, hop_payload_4},
    ]

    [packet, shared_secrets, blinding_factors, ephem_keys, filler, rho_keys, mu_keys, routing_info_unencrypted, routing_info_encrypted | _] = 
      OnionPacketV0.create_with_intermediates(hops, session_key, associated_data)

    assert Enum.at(shared_secrets, 0) |> hex() == hop_shared_secret_0
    assert Enum.at(shared_secrets, 1) |> hex() == hop_shared_secret_1
    assert Enum.at(shared_secrets, 2) |> hex() == hop_shared_secret_2
    assert Enum.at(shared_secrets, 3) |> hex() == hop_shared_secret_3
    assert Enum.at(shared_secrets, 4) |> hex() == hop_shared_secret_4

    assert Enum.at(blinding_factors, 0) |> hex() == hop_blinding_factor_0
    assert Enum.at(blinding_factors, 1) |> hex() == hop_blinding_factor_1
    assert Enum.at(blinding_factors, 2) |> hex() == hop_blinding_factor_2
    assert Enum.at(blinding_factors, 3) |> hex() == hop_blinding_factor_3
    assert Enum.at(blinding_factors, 4) |> hex() == hop_blinding_factor_4

    assert Enum.at(ephem_keys, 0) |> KeyUtils.compress() |> hex() == hop_ephemeral_pubkey_0
    assert Enum.at(ephem_keys, 1) |> KeyUtils.compress() |> hex() == hop_ephemeral_pubkey_1
    assert Enum.at(ephem_keys, 2) |> KeyUtils.compress() |> hex() == hop_ephemeral_pubkey_2
    assert Enum.at(ephem_keys, 3) |> KeyUtils.compress() |> hex() == hop_ephemeral_pubkey_3
    assert Enum.at(ephem_keys, 4) |> KeyUtils.compress() |> hex() == hop_ephemeral_pubkey_4

    assert filler |> hex() == expected_filler

    assert Enum.at(rho_keys, 4) |> hex() == rhokey_4
    assert Enum.at(rho_keys, 3) |> hex() == rhokey_3
    assert Enum.at(rho_keys, 2) |> hex() == rhokey_2
    assert Enum.at(rho_keys, 1) |> hex() == rhokey_1
    assert Enum.at(rho_keys, 0) |> hex() == rhokey_0

    assert Enum.at(mu_keys, 4) |> hex() == mukey_4
    assert Enum.at(mu_keys, 3) |> hex() == mukey_3
    assert Enum.at(mu_keys, 2) |> hex() == mukey_2
    assert Enum.at(mu_keys, 1) |> hex() == mukey_1
    assert Enum.at(mu_keys, 0) |> hex() == mukey_0

    assert Enum.at(routing_info_unencrypted, 4) |> hex() == routing_info_4_unencrypted
    assert Enum.at(routing_info_unencrypted, 3) |> hex() == routing_info_3_unencrypted
    assert Enum.at(routing_info_unencrypted, 2) |> hex() == routing_info_2_unencrypted
    assert Enum.at(routing_info_unencrypted, 1) |> hex() == routing_info_1_unencrypted
    assert Enum.at(routing_info_unencrypted, 0) |> hex() == routing_info_0_unencrypted

    assert Enum.at(routing_info_encrypted, 4) |> hex() == routing_info_4_encrypted
    assert Enum.at(routing_info_encrypted, 3) |> hex() == routing_info_3_encrypted
    assert Enum.at(routing_info_encrypted, 2) |> hex() == routing_info_2_encrypted
    assert Enum.at(routing_info_encrypted, 1) |> hex() == routing_info_1_encrypted
    assert Enum.at(routing_info_encrypted, 0) |> hex() == routing_info_0_encrypted

    assert packet.version == 0
    assert hex(packet.public_key) == String.slice(onion_packet, 1*2, 33*2)
    assert hex(packet.hops_data) == String.slice(onion_packet, 34*2, 1300*2)
    assert hex(packet.hmac) == String.slice(onion_packet, -32*2, 32*2)
    
    packet_binary = OnionPacketV0.encode(packet)
    assert packet_binary |> hex() == onion_packet
  end

  defp parse_hop_payload_hex(h) do
    <<realm, rest::binary>> = bin(h)
    PerHop.parse(realm, rest)
  end

  defp hex(b) do
    Base.encode16(b, case: :lower)
  end

  defp bin(h) do
    Base.decode16!(h, case: :lower)
  end
end
